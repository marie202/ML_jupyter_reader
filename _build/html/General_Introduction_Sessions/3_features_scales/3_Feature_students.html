

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. Feature Scales &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'General_Introduction_Sessions/3_features_scales/3_Feature_students';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FGeneral_Introduction_Sessions/3_features_scales/3_Feature_students.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/General_Introduction_Sessions/3_features_scales/3_Feature_students.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3. Feature Scales</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#empirical-modelling">1. Empirical modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-relevant-here">Question relevant here:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-problem">Understanding the Problem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-model-design">2. Introduction to model design</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematics-spaces">2.1. Mathematics – spaces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-scales-and-machine-learning-approaches">2.2. Feature scales and machine learning approaches</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-models-sensitive-to-feature-scale"><strong>ML Models sensitive to feature scale</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-models-not-sensitive-to-feature-scale"><strong>ML models not sensitive to feature scale</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reasons-for-transformations">3. Reasons for transformations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#algebraic-constraints-on-limited-feature-scales">3.1. Algebraic constraints on limited feature scales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skewness-symmetry-and-normality">3.2. Skewness, symmetry and normality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-a-dataset">Working with a Dataset</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-constrained-feature-spaces">3.3. Double constrained feature spaces</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-northern-hemispheric-ice-extent-under-climate-change">3.3.1. Example: Northern hemispheric ice extent under climate change</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compositional-contraints">3.4. Compositional contraints</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="feature-scales">
<h1>3. Feature Scales<a class="headerlink" href="#feature-scales" title="Permalink to this heading">#</a></h1>
<section id="empirical-modelling">
<h2>1. Empirical modelling<a class="headerlink" href="#empirical-modelling" title="Permalink to this heading">#</a></h2>
<div style="display:flex; align-items: center;">
     <div style="color:#FFA533; padding:70px; font-size: 18px;font-weight:bold">
<section id="question-relevant-here">
<h3>Question relevant here:<a class="headerlink" href="#question-relevant-here" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>What is a good model?</p></li>
<li><p>How to set up a good model?</p></li>
<li><p>How to decide if a published model is potentially valid?</p></li>
</ul>
<blockquote>
<div><p><strong>Nice <a class="reference external" href="https://www.youtube.com/watch?v=-cfvaNQFozI&amp;amp;list=PLlQWnS27jXh-t3cHfH8oMr8R3-jMvZJn6">Introductory Video</a> !!</strong></p>
</div></blockquote>
</div>
     <div style="flex:1;padding-left:10px;">
          <img width="400" src="https://imgs.xkcd.com/comics/curve_fitting.png" />
     </div>
</div></section>
<section id="understanding-the-problem">
<h3>Understanding the Problem<a class="headerlink" href="#understanding-the-problem" title="Permalink to this heading">#</a></h3>
<ol class="arabic">
<li><p>almost all geoscientific characteristics are limited in scale space</p></li>
<li><p>statistics can estimate unknown (value) limits from observations</p></li>
<li><p>algebraic limits must be observed:</p>
<p>variable transformations must be carried out for certain calculations!
Observing algebraic restrictions makes sense in terms of content!</p>
</li>
</ol>
<p>The absolute majority of statistical methods is designed for unlimited rational (ℚ) or real feature scales (ℝ), thus any number between −∞ and +∞ are generally possible. We are expecting meaningful algebraic operations and ideally symmetric or better normal populations.</p>
<p>But nearly all variables are at least one-sided limited to the positive branch of ℝ or ℚ. Hereby, zeros are mostly meaningless and nearly always represent missing values. From an algebraic point of view only multiplication/division cannot leave the feature scale and mislead to estimate insufficient statistical parameters such as arithmetic mean or variances.</p>
<p>A closer look often reveals an additional upper limit of our variables space, mostly related to the physical frame of our planets gravity field and/or limited resources, ecological constraints and other reasons (distances, heights, temperature, counts of individuals, areas, brightness values, etc.).
Furthermore, relative amounts or compositions are leading to spurious and sometimes crazy correlations or artificial patterns.</p>
<p>Therefore we have to “open” our bounded scales in order to perform mathematical/statistical right and meaningful results with regards to scientific contents.
Many transformation are proposed in terms of achieving normality or symmetry. Some of them only change the shapes of distributions whereas other are solving algebraic constraints.
Here, we are presenting linear and non-linear transformation as well as transformation for double constraint feature scales of compositional or physical nature.</p>
<blockquote>
<div><p><strong>(Nearly) all variables in Geosciences are limited to positive numbers!!!</strong></p>
</div></blockquote>
</section>
</section>
<section id="introduction-to-model-design">
<h2>2. Introduction to model design<a class="headerlink" href="#introduction-to-model-design" title="Permalink to this heading">#</a></h2>
<p><strong>Basic principles:</strong>  Mathematics, Physics &amp; Statistics</p>
<p><strong>Model design:</strong> Requirements, Recipe &amp; Testing of existing models</p>
<blockquote>
<div><p><strong>scale of measurement! –&gt; The guiding principle: design models in the real space!</strong></p>
</div></blockquote>
<section id="mathematics-spaces">
<h3>2.1. Mathematics – spaces<a class="headerlink" href="#mathematics-spaces" title="Permalink to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Space</p></th>
<th class="head"><p>Notation</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Characteristics</p></th>
<th class="head"><p>Examples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Real Space</p></td>
<td><p><span class="math notranslate nohighlight">\({\rm I\!R}\)</span></p></td>
<td><p>interval scale</p></td>
<td><p><span class="math notranslate nohighlight">\([-\infty, +\infty\)</span>]</p></td>
<td><p>time &amp; space (location), e.g. UTM coordinates, changing the point of reference does not affect the pattern of the data.</p></td>
</tr>
<tr class="row-odd"><td><p>Positive Real Space</p></td>
<td><p><span class="math notranslate nohighlight">\({\rm I\!R^+}\)</span></p></td>
<td><p>ratio scale</p></td>
<td><p><span class="math notranslate nohighlight">\(]0, +\infty]\)</span></p></td>
<td><p>most physical quantities, e.g. temperature expressed in K (Kelvin), distance, time span, speed, permeability, and discharge.There is no origin on this scale: zero is a limiting value.</p></td>
</tr>
<tr class="row-even"><td><p>Simplex</p></td>
<td><p><span class="math notranslate nohighlight">\(S\)</span></p></td>
<td><p>compositional scale</p></td>
<td><p><span class="math notranslate nohighlight">\(]0,1[\)</span></p></td>
<td><p>Sum must equal a constant (1 for proportions, 100 for percentages, <span class="math notranslate nohighlight">\(10^6\)</span> for ppm, e.g. concentrations, mass/ volume fractions</p></td>
</tr>
</tbody>
</table>
</div>
<div>
<img src="figures/2worlds_edit.png" width="1000"/>
</div>
<blockquote>
<div><p>If you need a refresher in maths and logarithms, I recommend <a class="reference external" href="https://www.youtube.com/watch?v=gp9HB1lUQ48">this video on YouTube.</a></p>
</div></blockquote>
</section>
<section id="feature-scales-and-machine-learning-approaches">
<h3>2.2. Feature scales and machine learning approaches<a class="headerlink" href="#feature-scales-and-machine-learning-approaches" title="Permalink to this heading">#</a></h3>
<hr class="docutils" />
<blockquote>
<div><p>This is by no means a new idea !</p>
<p><strong>Ada (Byron) Lovelace</strong>  <em>(letter to A. de Morgan 1840)</em>:</p>
<blockquote>
<div><p>“I may remark that the curious transformations many formulae can undergo,
the unsuspected and to a beginner apparently impossible identity of forms exceedingly dissimilar at first sight,
is I think one of the chief difficulties in […]mathematical studies.</p>
<p>I am often reminded of certain sprites and fairies one reads of, who are at one’s elbows in one shape now, and the next minute in a form most dissimilar.”</p>
<p><em>(see Toole, B.A., 1998. Ada, the Enchantress of Numbers: Prophet of the Computer Age, Strawberry Press,
ISBN 0912647183. p. 99)</em></p>
</div></blockquote>
</div></blockquote>
<hr class="docutils" />
<p>As discussed above, normalization, scaling, standardization and transformations are crucial requirements for reliable and robust application of statistical methods beyond simple data description for getting meaningful results. Especially application of complex machine learning algorithms for exploration of multivariate data patterns it often becomes likely to get entrapped for violation of important preconditions. Hereby, it can be the violation of scale homogeneity using gradient descent related optimization technics or non-euclidean feature space for distance or angle related technics as well as simple violation of algebraic constraints.</p>
<p>A brief overview of common risk concerning serious pitfall is provided by Minkyung Kang in his <a class="reference external" href="https://mkang32.github.io/python/2020/12/27/feature-scaling.html#why">data science blog</a>:</p>
<section id="ml-models-sensitive-to-feature-scale">
<h4><strong>ML Models sensitive to feature scale</strong><a class="headerlink" href="#ml-models-sensitive-to-feature-scale" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Algorithms that use gradient descent as an optimization technique</p>
<ul>
<li><p>Linear Regression</p></li>
<li><p>Neural Networks</p></li>
</ul>
</li>
<li><p>Distance-based algorithms</p>
<ul>
<li><p>Support Vector Machines</p></li>
<li><p>KNN</p></li>
<li><p>K-means clustering
<em>Algorithms using directions of maximized variances</em></p></li>
<li><p>PCA / SVD</p></li>
<li><p>LDA</p></li>
</ul>
</li>
</ul>
</section>
<section id="ml-models-not-sensitive-to-feature-scale">
<h4><strong>ML models not sensitive to feature scale</strong><a class="headerlink" href="#ml-models-not-sensitive-to-feature-scale" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Tree-based algorithms</p></li>
<li><p>Decision Tree</p></li>
<li><p>Random Forest</p></li>
<li><p>Gradient Boosted Trees</p></li>
</ul>
</section>
</section>
</section>
<section id="reasons-for-transformations">
<h2>3. Reasons for transformations<a class="headerlink" href="#reasons-for-transformations" title="Permalink to this heading">#</a></h2>
<p>There are nearly unlimited reasons for scale transformation. Just to name a few, we focus on the following:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.geo.fu-berlin.de/en/v/soga-py/Advanced-statistics/Feature-scales/Reasons-for-transformation/index.html">Scale homogeneity</a> (e.g. different units, physical restriction)</p></li>
<li><p>Algebraic constraints on positive feature scales</p></li>
<li><p>Skewness, symmetry and normality</p></li>
<li><p>Double constraint feature scales</p></li>
<li><p>Compositional data sets</p></li>
</ul>
<section id="algebraic-constraints-on-limited-feature-scales">
<h3>3.1. Algebraic constraints on limited feature scales<a class="headerlink" href="#algebraic-constraints-on-limited-feature-scales" title="Permalink to this heading">#</a></h3>
<p>Most real-world variables can only be positive (e.g. <span class="math notranslate nohighlight">\(\mathbb{R_+}\)</span> or <span class="math notranslate nohighlight">\(]0,+\infty]\)</span> or are limited  to an interval (<span class="math notranslate nohighlight">\(]a,b[_\mathbb{R_+}\)</span>). Exceeding these boundaries by algebraic operations such as (+,-,*,/) leads to useless or meaning less results.</p>
<p><strong>Example</strong></p>
<p>On the scale of positive real numbers <span class="math notranslate nohighlight">\(\mathbb{R_+}\)</span> multiplication and the inverse operation division can not leave the set of positive real numbers. Thus, the positive real numbers together with the multiplication, denoted by <span class="math notranslate nohighlight">\((\mathbb{R_+},*)\)</span>, form a commutative group with 1 as neutral element.
In contrast, the set of positive real numbers together with the addition <span class="math notranslate nohighlight">\((\mathbb{R_+},+)\)</span> has neither inverse elements nor a neutral element. Thus, addition and subtraction can not be unlimited performed.
But a log-transformation of any variable
$<span class="math notranslate nohighlight">\(x\in\mathbb{R_+}: x\to x'=\log(x)\)</span><span class="math notranslate nohighlight">\( 
opens the scale to \)</span>x’\to\mathbb{R}<span class="math notranslate nohighlight">\( and transforms the neutral element of \)</span>(\mathbb{R_+},\cdot)<span class="math notranslate nohighlight">\( given by 1 to the neutral element of \)</span>(\mathbb{R},+)<span class="math notranslate nohighlight">\(, given by 0!
The field of \)</span>(\mathbb{R},+,\cdot)<span class="math notranslate nohighlight">\( provides nearly unlimited operations for statistical purposes (except e.g. \)</span>\sqrt{-1}<span class="math notranslate nohighlight">\( or \)</span>\frac{1}{0}$).</p></p>
<p>The inverse transformation powering 
$$x'\to x=e^{x'}$$</p>
<p>reverse the log-transformation back to the positive reel scale.</p></section>
<section id="skewness-symmetry-and-normality">
<h3>3.2. Skewness, symmetry and normality<a class="headerlink" href="#skewness-symmetry-and-normality" title="Permalink to this heading">#</a></h3>
<p>One reason for right skewed distributions can be the Hoelder inequality
<span class="math notranslate nohighlight">\(\bar{x}_{geo}\leq \bar{x}_{arith}\)</span>
, but is not sufficient as explanation. Let us recall the geometric mean:</p>
<p>\begin{align}
\bar{x}<em>{geo}=\sqrt[n]{\prod</em>{i=1}^N x_i}=\prod_{i=1}^N x_i^{\frac{1}{n}}= x_1^{\frac{1}{n}}\cdot x_2^{\frac{1}{n}}\cdots x_n^{\frac{1}{n}}
\end{align}</p>
<p>The main apparent difference between these two means is the operator: sum for arithmetic mean and product for the geometric mean. Thus, the arithmetic mean recommend for an additive or distance scale and the geometric mean for a ratio scale approach. In our case, we are dealing with a variable clearly hosted on the
R+-scale where only multiplication is unlimited allowed.</p>
<p><strong>But we often need an arithmetic mean for further statistical parameters: e.g.</strong></p>
<ul class="simple">
<li><p>standard deviation</p></li>
<li><p>skewness</p></li>
<li><p>covariance</p></li>
<li><p>correlation</p></li>
<li><p>regression</p></li>
<li><p>etc.</p></li>
</ul>
<p>To solve this problem, we can apply the logarithm to the geometric mean:</p>
<p>\begin{align}
log(\bar{x}<em>{geo}) &amp; =log(x_1^{\frac{1}{n}}\cdot x_2^{\frac{1}{n}}\cdots x_n^{\frac{1}{n}})= \
&amp; =\frac{1}{n}log(x_1)+\frac{1}{n}log(x_2)+\cdots+\frac{1}{n}log(x_N)= \
&amp; =\frac{1}{n}\sum</em>{i=1}^{N}{log(x_i)}={\overline{log(x_i)}}_{arith}
\end{align}</p>
<section id="working-with-a-dataset">
<h4>Working with a Dataset<a class="headerlink" href="#working-with-a-dataset" title="Permalink to this heading">#</a></h4>
<p>We begin by loading the meteorological data set from the <a class="reference external" href="https://opendata.dwd.de/climate_environment/CDC/observations_germany/climate/monthly/kl/historical/">Deutscher Wetterdienst DWD (German Weather Service) Open Climate Data Center </a>. You find a documentation of this data in <a class="reference external" href="https://opendata.dwd.de/climate_environment/CDC/observations_germany/climate/monthly/kl/historical/BESCHREIBUNG_obsgermany_climate_monthly_kl_historical_de.pdf">german</a> and  <a class="reference external" href="https://opendata.dwd.de/climate_environment/CDC/observations_germany/climate/monthly/kl/historical/DESCRIPTION_obsgermany_climate_monthly_kl_historical_en.pdf">english</a>.</p>
<blockquote>
<div><h4 class="rubric" id="exercise">Exercise:</h4>
<p>Calculate standard deviation and arith. Mean of the monthly sum of precipitaiton height!</p>
<p>Check the 3-sigma rule and plot the distribution!</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, let&#39;s import all the needed libraries.</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># First, let&#39;s import all the needed libraries.</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pandas&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read dataset from online ressource</span>
<span class="n">dahlem_clim</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://userpage.fu-berlin.de/soga/data/raw-data/NS_TS_Dahlem.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span>
<span class="p">)</span>
<span class="n">dahlem_clim</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># display first 10 entries</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATIONS_ID</th>
      <th>MESS_DATUM_BEGINN</th>
      <th>MESS_DATUM_ENDE</th>
      <th>QN_4</th>
      <th>MO_N</th>
      <th>MO_TT</th>
      <th>MO_TX</th>
      <th>MO_TN</th>
      <th>MO_FK</th>
      <th>MX_TX</th>
      <th>MX_FX</th>
      <th>MX_TN</th>
      <th>MO_SD_S</th>
      <th>QN_6</th>
      <th>MO_RR</th>
      <th>MX_RS</th>
      <th>eor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>403</td>
      <td>17190101</td>
      <td>17190131</td>
      <td>5</td>
      <td>-999.0</td>
      <td>2.8</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
    <tr>
      <th>1</th>
      <td>403</td>
      <td>17190201</td>
      <td>17190228</td>
      <td>5</td>
      <td>-999.0</td>
      <td>1.1</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
    <tr>
      <th>2</th>
      <td>403</td>
      <td>17190301</td>
      <td>17190331</td>
      <td>5</td>
      <td>-999.0</td>
      <td>5.2</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
    <tr>
      <th>3</th>
      <td>403</td>
      <td>17190401</td>
      <td>17190430</td>
      <td>5</td>
      <td>-999.0</td>
      <td>9.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
    <tr>
      <th>4</th>
      <td>403</td>
      <td>17190501</td>
      <td>17190531</td>
      <td>5</td>
      <td>-999.0</td>
      <td>15.1</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
    <tr>
      <th>5</th>
      <td>403</td>
      <td>17190601</td>
      <td>17190630</td>
      <td>5</td>
      <td>-999.0</td>
      <td>19.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
    <tr>
      <th>6</th>
      <td>403</td>
      <td>17190701</td>
      <td>17190731</td>
      <td>5</td>
      <td>-999.0</td>
      <td>21.4</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
    <tr>
      <th>7</th>
      <td>403</td>
      <td>17190801</td>
      <td>17190831</td>
      <td>5</td>
      <td>-999.0</td>
      <td>18.8</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
    <tr>
      <th>8</th>
      <td>403</td>
      <td>17190901</td>
      <td>17190930</td>
      <td>5</td>
      <td>-999.0</td>
      <td>13.9</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
    <tr>
      <th>9</th>
      <td>403</td>
      <td>17191001</td>
      <td>17191031</td>
      <td>5</td>
      <td>-999.0</td>
      <td>9.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>eor</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dahlem_NS</span> <span class="o">=</span> <span class="n">dahlem_clim</span><span class="o">.</span><span class="n">MO_RR</span><span class="p">[</span><span class="mi">2767</span><span class="p">:</span><span class="mi">3510</span><span class="p">]</span> <span class="c1">#subset precip. MO_RR, starting 1961</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Calculate the mean and standard deviation of the logarithmised values and transform them back!</p>
<p>Calculate the limits of the 3-sigma rule in the same way!</p>
</div></blockquote>
</section>
</section>
<section id="double-constrained-feature-spaces">
<h3>3.3. Double constrained feature spaces<a class="headerlink" href="#double-constrained-feature-spaces" title="Permalink to this heading">#</a></h3>
<p>There is a certain relation to the compositional constraint if we face double bounded feature spaces.
Let us imagine a variable $\mathbf{x}=(x_i\in ]l,u[_\mathbb R,i=1,\cdots,m)$ within a constrained interval [a,b]$\subset \mathbb R$. The absolute value is obviously of minor interest compared with the relative position between l and u. A first step should be a linear min-max-transformation wit min=l and max=u:</p>
$$ x \to x' =\frac{x-l}{u-l} \in\ ]0,1[\ \in \ {\mathbb R}_+ $$<p>Now, x' divides the interval into two parts: 1. the distance to the left (=x) and 2. the distance to the right (1-x). Both sum up to 1 and are therefore related to a 2-dimensional composition.
<p>In Application, the formula should look like this:</p>
<div class="math notranslate nohighlight">
\[x'=\frac{x-x_{min}+1}{x_{max}-x_{min}+2\, .}\]</div>
<p>Applying an alr-transformation to our variable, we are getting a symmetric feature scale:
$<span class="math notranslate nohighlight">\( x'\to x''=\log(\frac{x'}{1-x'})\in \mathbb R\)</span><span class="math notranslate nohighlight">\(
This so-called &lt;em&gt;logistic transformation&lt;/em&gt; enable application of algebraic operation over the base field \)</span>\mathbb R$.</p></p>
<p>The back transformations are:</p>
<p>The back transformation is the “logistic” function resp. inverse logit:</p>
<p>\begin{align}
x’’\to x’=\frac{e^{x’’}}{1+e^{x’’}}&amp;&amp; and &amp;&amp;
x’\to x=(x’+l)\cdot(u-l)
\end{align}</p>
<p>\begin{align}
&amp;&amp; resp. &amp;&amp;
x’\to x= ({x’+x_{min}+1})\cdot(x_{max}-x_{min}+2)
\end{align}</p>
<section id="example-northern-hemispheric-ice-extent-under-climate-change">
<h4>3.3.1. Example: Northern hemispheric ice extent under climate change<a class="headerlink" href="#example-northern-hemispheric-ice-extent-under-climate-change" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference external" href="https://nsidc.org/home">National Snow and Ice Data Center</a> at the University of Colorado in Boulder hosts and provides monthly sea ice data for both hemispheres since November 1978 to present. Under the condition of a warming earth system, we will estimate the changes for the northern hemisphere and project a possible trend until the end of this century for September.</p>
<p><strong>Step 1: Loading the data and plotting the time series</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># open the data set as csv file using pandas</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ftp://sidads.colorado.edu/DATASETS/NOAA/G02135//north/monthly/data/N_09_extent_v3.0.csv&#39;</span><span class="p">,</span> <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>mo</th>
      <th>data-type</th>
      <th>region</th>
      <th>extent</th>
      <th>area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1979</td>
      <td>9</td>
      <td>Goddard</td>
      <td>N</td>
      <td>7.05</td>
      <td>4.58</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1980</td>
      <td>9</td>
      <td>Goddard</td>
      <td>N</td>
      <td>7.67</td>
      <td>4.87</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1981</td>
      <td>9</td>
      <td>Goddard</td>
      <td>N</td>
      <td>7.14</td>
      <td>4.44</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1982</td>
      <td>9</td>
      <td>Goddard</td>
      <td>N</td>
      <td>7.30</td>
      <td>4.43</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1983</td>
      <td>9</td>
      <td>Goddard</td>
      <td>N</td>
      <td>7.39</td>
      <td>4.70</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use seaborn for plotting</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;extent&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Ice cover extent september&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;million sqrkm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;million sqrkm&#39;)
</pre></div>
</div>
<img alt="../../_images/a9fc69175ab8360243cf56961258d8a9ee472c91594d6afd05f83b8560ed8670.png" src="../../_images/a9fc69175ab8360243cf56961258d8a9ee472c91594d6afd05f83b8560ed8670.png" />
</div>
</div>
<p><strong>Step 2: Prediction</strong></p>
<p>Now, we may estimate the linear trend using seeborn.regplot. If we set ‘truncate = True’ regression line is bounded by the data limits. If we set ‘truncate = False’, it extends to the x axis limits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1975</span><span class="p">,</span><span class="mi">2100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;extent&#39;</span><span class="p">,</span> <span class="n">truncate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="mi">95</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Prediction of the ice cover extent september&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;million sqrkm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;million sqrkm&#39;)
</pre></div>
</div>
<img alt="../../_images/0a30eba5da916107bda49c3494f3d78e33564df68a7beb3d789f053117716fdf.png" src="../../_images/0a30eba5da916107bda49c3494f3d78e33564df68a7beb3d789f053117716fdf.png" />
</div>
</div>
<p>Modeling the observed ice cover extent from 1979 to 2020 for the northern hemisphere in September for the future, we have to expect a complete disappearance of the arctic ice in late summer with 95% probability within the second half of this century!</p>
<p>In 2035 we may expect an ICE in september with 95% confidence level between 2.07 and 4.41 milion sqrkm, therefore between 51.83% and 110.3% of last september extent.</p>
<p>In 2050 we may expect an ICE in September with 95% confidence level between 0.8 and 3.31 milion sqrkm, therefore between 20.09% and 82.77% of last september extent.</p>
<blockquote>
<div><p>The feature scale of the arctic ice extent in million square kilometer is clearly framed by a <strong>lower and upper limit</strong>: The extent definitly can neither be negative nor pass the equator. Thus, the lower limit is trivial but the upper limit unknown.</p>
</div></blockquote>
<p>For the sake of simplicity we initially use the maximum extent as upper limit and remove this maximum from our time series and start a logistic approach:</p>
<p><strong>Step 3: Logistic Transformation</strong></p>
<p>We start by scaling the data to the standard simplex ]0,1[ℝ+ by deviding the data by the maximum as estimate of the upper limit. Afterward we transform the standard simplex by logistic transformation and plot the transfomed time series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent lrt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent&#39;</span><span class="p">]</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent&#39;</span><span class="p">])</span>  

<span class="c1"># if we hit the maximum, the outcome is 1. For this value, we can not calculate the logarithm. Therefore, we need</span>
<span class="c1"># to exclude the value or approximate it by, e.g. 0.999999:</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent lrt&#39;</span><span class="p">])):</span>

    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.999999</span>



<span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent lrt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent lrt&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent lrt&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Plot the data:</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;extent lrt&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Ice cover extent after logistic transformation&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ICE logistic space&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;ICE logistic space&#39;)
</pre></div>
</div>
<img alt="../../_images/721bef0483ade02642452738276bcce076ff4e002345d0c20a83370b788ca3a2.png" src="../../_images/721bef0483ade02642452738276bcce076ff4e002345d0c20a83370b788ca3a2.png" />
</div>
</div>
<p><strong>Step 4: Estimating the trend</strong></p>
<p>Now, we can fit a linear model in the log-space:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1977</span><span class="p">,</span><span class="mi">2100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plot_des</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;extent lrt&#39;</span><span class="p">,</span> <span class="n">truncate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Prediction of ICE decrease for september log-space&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ICE logistic space&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;ICE logistic space&#39;)
</pre></div>
</div>
<img alt="../../_images/da12f6642ed57635e1e586e5824e0f88eed7774be4ab770932a73c8c4b7f8141.png" src="../../_images/da12f6642ed57635e1e586e5824e0f88eed7774be4ab770932a73c8c4b7f8141.png" />
</div>
</div>
<p>Interpreting the zero base of the upper plot, half of the former ice cover extent (expressed by the maximum of observation) has dissapeared since roughly 2010.</p>
<p>Back transformation in the original space:</p>
<p>Next, let us us transform the model in the original space by</p>
<div class="math notranslate nohighlight">
\[ICE = \frac{ e^{bx+a} }{1+e^{bx+a}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Since sns.regplot does not provide the coefficients of the regression line, we calculate the </span>
<span class="c1"># coefficients by statmodels. Both approaches calculate the parameters analogously, so we may do this.</span>


<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span>  <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1"># 95% confidence interval</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="c1">#lr = sm.OLS(y, sm.add_constant(x)).fit()</span>
<span class="c1">#print(lr.params)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># Slope: a</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Intercept: b</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Confidence intervals: </span>
<span class="n">lr_ci</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># enlarge data until the year 2100:</span>
<span class="n">x_1979_2100</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1979</span><span class="p">,</span><span class="mi">2100</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
<span class="c1">#x_test = [1] * len(x_1979_2100)</span>
<span class="n">x_1979_2100</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x_1979_2100</span> <span class="p">)</span>

<span class="n">y_1979_2100</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_1979_2100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:             extent lrt   R-squared:                       0.381
Model:                            OLS   Adj. R-squared:                  0.366
Method:                 Least Squares   F-statistic:                     26.42
Date:                Mon, 06 May 2024   Prob (F-statistic):           6.40e-06
Time:                        08:50:22   Log-Likelihood:                -86.781
No. Observations:                  45   AIC:                             177.6
Df Residuals:                      43   BIC:                             181.2
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const        202.7756     39.110      5.185      0.000     123.902     281.649
year          -0.1005      0.020     -5.140      0.000      -0.140      -0.061
==============================================================================
Omnibus:                       81.579   Durbin-Watson:                   2.337
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             1377.022
Skew:                           4.699   Prob(JB):                    9.63e-300
Kurtosis:                      28.418   Cond. No.                     3.08e+05
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 3.08e+05. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/vs/k3tcf9r11xq5pqzsg6kq3sx00000gn/T/ipykernel_8442/3207383392.py:17: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  a = lr.params[1]
/var/folders/vs/k3tcf9r11xq5pqzsg6kq3sx00000gn/T/ipykernel_8442/3207383392.py:20: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  b = lr.params[0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent back trafo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent lrt&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent lrt&#39;</span><span class="p">])))</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#predict until 2021:</span>

<span class="n">lr_back</span>  <span class="o">=</span> <span class="p">((</span>
    <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x_1979_2100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">b</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x_1979_2100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">b</span><span class="p">))))</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">x_1979_2100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1979
1      1980
2      1981
3      1982
4      1983
       ... 
116    2095
117    2096
118    2097
119    2098
120    2099
Name: year, Length: 121, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Let us have a look on the scatter plot of the transformed data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;extent back trafo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ICE decrease for september log-space&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sea ice extend in mio. sqrkm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Sea ice extend in mio. sqrkm&#39;)
</pre></div>
</div>
<img alt="../../_images/f2e0daaeb5499d38eefb8de42c3d2d7175585ed8e4f4c8f402d751db551f203a.png" src="../../_images/f2e0daaeb5499d38eefb8de42c3d2d7175585ed8e4f4c8f402d751db551f203a.png" />
</div>
</div>
<p>Estimating the trend:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In order to plot the logistic regresion line (orange line below, we create a new data set with the back transformed data </span>
<span class="c1"># of the linear regression line</span>

<span class="n">d_1979_2100</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_1979_2100</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;extent&#39;</span> <span class="p">:</span> <span class="n">lr_back</span> <span class="p">}</span>
<span class="n">df_1979_2100</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">d_1979_2100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1977</span><span class="p">,</span><span class="mi">2100</span><span class="p">)</span>
<span class="n">plot_des</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;extent back trafo&#39;</span><span class="p">,</span> <span class="n">truncate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Prediction of ICE decrease for september log-space&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ICE logistic space&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_1979_2100</span> <span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;extent&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/anaconda3/envs/lehre/lib/python3.12/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/opt/anaconda3/envs/lehre/lib/python3.12/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;Prediction of ICE decrease for september log-space&#39;}, xlabel=&#39;year&#39;, ylabel=&#39;ICE logistic space&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/1c4c64927ecf9cb3e8919eeb97034bc700e7f1b5442f38bb411b9cf3859e1405.png" src="../../_images/1c4c64927ecf9cb3e8919eeb97034bc700e7f1b5442f38bb411b9cf3859e1405.png" />
</div>
</div>
<p>As an exercise, you can transform the confidence intervals of the regression line in the log space and you will get the following result:</p>
<p>With 95% probability, the arctic ice extent may pass the 1-million sqrkm marker between 2030 and 2070 and a complete disappearance in the second half of our century. This simple empirical estimation is able to confirm the sophisticated physical modeling approach by <a class="reference external" href="https://doi.org/10.3390/cli8010015">Peng et al. 2020</a>.</p>
</section>
</section>
<section id="compositional-contraints">
<h3>3.4. Compositional contraints<a class="headerlink" href="#compositional-contraints" title="Permalink to this heading">#</a></h3>
<p>Compositional data is a special type of of non-negative data, which carries the relevant information in the ratios between the variables rather than in the actual data values. The individual parts of the composition are called components or parts. Each component has an amount, representing its importance within the whole. The sum over the amounts of all components is called the total amount, and portions are the individual amounts divided by this total amount (van den Boogaart and Tolosana-Delgado 2013).</p>
<blockquote>
<div><p>Compositions are sets of variables which values sum up to a constant, e.g.</p>
</div></blockquote>
<ul class="simple">
<li><p>dissolved cations and anions in a liquid</p></li>
<li><p>frequencies of population groups (e.g. employees, jobless people, etc.)</p></li>
<li><p>role allocation of a person during a time span in behavioral sciences</p></li>
<li><p>nutrition content for food declaration</p></li>
<li><p>many, many more …</p></li>
</ul>
<p>The great challenge of compositional data is that no single component can be regarded as independent from other. This means, if you observe a (e.g. spatial or temporal) pattern within one single component, at least parts of the pattern is likely rather attributed to another part of the composition than the (spatial or temporal) behaviour of the varibale of interest it self. Due to the compositional nature of such variable, they can neither be independent nor normal.</p>
<p><strong>A simple example:</strong></p>
<div>
<img src="figures/compstats.png" width="800"/>
</div>
<p>Imagine two measurements of a 2-part composition which sum up to a whole: Within measurement 1, both parts are uniform with exact 50% of the whole composition. Measurement 2 is showing up with 70% of the dark gray component and 30% the light grey one. How can we describe the difference:
Has the dark grey component increased whereas the light grey remained constant or has the light grey component decreased and the dark grey remained constant? It is absolutely impossible to decide what has happened, because both cases would show up with a similar pattern. Furthermore, we have to consider that all values are strictly positive and thus, differences are rather related to ratios than for distances.</p>
<p>Hence, 40% of the lightgrey part has been shifted to the dark grey, but we still cannot decide whether x increased or y decreased.</p>
<p>What does this imply beside spurious correlations?</p>
<p>We can interpret the correlation coefficient as normalized cosine of the angle between the deviation vectors to the mean 
$$\mathbf{x}_{d}=(x_i-\bar{x},i=1,\cdots,n)$$</p>
<p>and</p>
$$ \mathbf{y}_{d}=(y_i-\bar{y},i=1,\cdots,n)$$
<p>The cosine of the angle between two vectors is calculated by the scalar product divided to the product of both norm: </p>
<div class="math notranslate nohighlight">
\[ 
\cos \measuredangle (\mathbf{x}, \mathbf{y})=\frac{&lt;\mathbf{x}, \mathbf{y}&gt;}{\parallel \mathbf{x} \parallel \cdot \parallel \mathbf{y} \parallel  }= \frac {\sum{x_i\cdot y_i }}{\sqrt{x_i^2}\cdot \sqrt{y_i^2}}\]</div>
<p>Setting $\mathbf{x} =\mathbf{x}-\overline{\mathbf{x}}$ and $\mathbf{y} =\mathbf{y}-\overline{\mathbf{y}}$, we are getting the scalar product as nominator for the covariance term and the product of the norms as standard deviation terms.</p>
<p>Thus, in compositions the deviations vectors as bases <strong>are oblique by nature</strong> and <strong>consequently non-euclidean</strong>!</p>
<p>Hence, statistical methods using distances and angles (ratios) as optimization parameters can not be applied on pure compositions. 
Such methods are e.g.:</p>
<ul>
<li>(ML-)regression and correlation, GLM, PCA, LDA, ANN</li>
<li>SVM, KNN, k-Means</li>
<li>most hypotheses tests, etc.</li>
</ul>
<p>Whereas, this problem is well known since <a href="https://en.wikipedia.org/wiki/Karl_Pearson">Karl Pearson</a> published the problem of spurious correlation in compositional data <a href="https://archive.org/details/proceedings60royauoft/page/488/mode/2up?view=theater">1897</a> more than 100 years ago <a href="https://doi.org/10.1029/JZ065i012p04185">Felix Chayes</a> suggest the use of ratios instead of portions:
$$ a,b \in ]0,1[_{\mathbb{R}}\to \frac{a}{b}\in \mathbb{R_+} $$
One of the remaining disadvantage was now the question about nominator and denominator, because of the often huge difference between a/b and b/a. Another problem was still the limit to the positive reel feature scale.</p>
<p>In 1981, the Scottish statistician <a href="https://en.wikipedia.org/wiki/John_Aitchison">John Aitchison</a> solved the problem introducing the log-ratios: 
$$ \log \frac{a}{b}=-\log \frac{b}{a}\in\mathbb R\, .$$
Thus, changing nominator and denominator just change the sign of the log-ratio but not the absolute value implies symmetry again (cf. paragraph above) 
In his Book <a href="https://openlibrary.org/books/OL2710015M/The_statistical_analysis_of_compositional_data">The statistical analysis of composional data, 1986</a> introduced</p>
<ol>
<li><strong>Additive log-ratio (alr)</strong> transformation is the logarithm of the ratio of each variable divided by a selected variable of the composition. Alr applied on a D-dimensional composition results in a D-1-dimensional variable space over the field $(\mathbb{R},+,\cdot)$. Unfortunately, beside a asymmetry in the parts, alr is not isometric. Thus, distances and angles are not consistence between simplex and the resulting D-1 dimensional subspace of $\mathbb{R}^D$.</li>
<li><strong>Centered log-ratio (clr)</strong> transformation is the logarithm of the ratio of each value divided through the geometric mean of all parts of the corresponding observation. The clr transformation is symmetric with respect to the compositional parts and keeps the same number of components as the number of parts in the composition. Due to the problem that orthogonal references in that subspace are not obtained in a straightforward manner, <a href="https://link.springer.com/article/10.1023/A:1023818214614">Egozcue et al. 2003</a> introduced:</li>
<li><strong>Isometric log-ratio (ilr)</strong> transformation is isometric and provides an orthonormal basis. Thus, distances and angles are independent from the sub-composition (symmetric in all parts of the sub-composition) comparable between the Aitchison simplex and the D-dimensional reel space.</li>
</ol>
<p>However, PCA or SVD-analysis on a clr-transformed simplex provides similar properties <a href="https://link.springer.com/article/10.1023/A:1023818214614">Egozcue et al. 2003</a>.</p>
<blockquote>
<div><h4 class="rubric" id="in-python-you-may-easily-use-the-compostions-stats-module-for-compostional-constraints">In Python you may easily use the <a class="reference external" href="https://pypi.org/project/composition-stats/">compostions.stats</a> module for compostional constraints!</h4>
<h4 class="rubric" id="learn-more-about-clr-alr-ilr-here">Learn more about clr, alr, ilr <a class="reference external" href="https://www.geo.fu-berlin.de/en/v/soga-r/Advances-statistics/Feature-scales/Logratio_Transformations/index.html">here</a>!</h4>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="n">fp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s2">&quot;https://userpage.fu-berlin.de/soga/soga-py/citation/citation_py.html&quot;</span><span class="p">)</span>
<span class="n">mybytes</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">citation</span> <span class="o">=</span> <span class="n">mybytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">citation</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><hr>
<p><strong>Citation</strong></p>
<p>The E-Learning project SOGA-Py was developed at the Department of Earth Sciences by Annette Rudolph, Joachim Krois and Kai Hartmann. You can reach us via mail by <a href="mailto:soga@zedat.fu-berlin.de">soga[at]zedat.fu-berlin.de</a>.</p>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />You may use this project freely under the <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
<p>Please cite as follow: <em>Rudolph, A., Krois, J., Hartmann, K. (2023): Statistics and Geodata Analysis 
using Python (<a target="_blank" href="https://www.geo.fu-berlin.de/soga-py">SOGA-Py</a>). Department of Earth Sciences, Freie Universitaet Berlin.</em></p></p>

<!-- JS resizer -->
<script type="text/javascript" src="https://medien.cedis.fu-berlin.de/services/cms-assets/iframeResizer/iframeResizer.js">
</script></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./General_Introduction_Sessions/3_features_scales"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#empirical-modelling">1. Empirical modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-relevant-here">Question relevant here:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-problem">Understanding the Problem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-model-design">2. Introduction to model design</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematics-spaces">2.1. Mathematics – spaces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-scales-and-machine-learning-approaches">2.2. Feature scales and machine learning approaches</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-models-sensitive-to-feature-scale"><strong>ML Models sensitive to feature scale</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-models-not-sensitive-to-feature-scale"><strong>ML models not sensitive to feature scale</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reasons-for-transformations">3. Reasons for transformations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#algebraic-constraints-on-limited-feature-scales">3.1. Algebraic constraints on limited feature scales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skewness-symmetry-and-normality">3.2. Skewness, symmetry and normality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-a-dataset">Working with a Dataset</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-constrained-feature-spaces">3.3. Double constrained feature spaces</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-northern-hemispheric-ice-extent-under-climate-change">3.3.1. Example: Northern hemispheric ice extent under climate change</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compositional-contraints">3.4. Compositional contraints</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>