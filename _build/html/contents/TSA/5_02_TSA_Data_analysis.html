
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6.2. Time Series Analysis Methods &#8212; Machine Learning Online Reader</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/TSA/5_02_TSA_Data_analysis';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7. Machine learning Algorithms I" href="../ML_algorithms/5_ML_Intro.html" />
    <link rel="prev" title="6.1. Time Series Preprocessing" href="5_01_TSA_Data_preprocessing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Machine Learning Online Reader - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Machine Learning Online Reader - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Machine Learning Intro Course Materials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_0_Intro_to_Python_landing.html">1. Introduction to Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_1_Python_as_calculator.html">1.1. Using Python as calculator</a></li>

<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_2_Build_in_Functions.html">1.3. Use of predefined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_3_data_structures.html">1.4. Data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_4_atomic_datatypes.html">1.5. Datatypes</a></li>


<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_5_objects_data_types.html">1.8. The concept of objects in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_6_Intro_user_defined_functions.html">1.9. User defined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_7_control_flow_mit_Lsg.html">1.10. Steering the control flow of a program</a></li>

<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_8_Pandas_Dataframes.html">1.12. Pandas package for handling <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_9_Exercises_Einf_Python_I.html">1.13. Additional Exercises I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/1_Introduction_to_Python/1_10_Exercises_Einf_Python_II.html">1.14. Additional Exercises II</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Recap Statistics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../General_Introduction_Sessions/2_NVT/2_1_Wdhl_Statisitk_1.html">2. Recap Statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/2_NVT/2_2_Add_Exercises_NVT.html">2.3. Additional Exercises III -  The Normal distribution</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Feature Scales</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../General_Introduction_Sessions/3_features_scales/3_Feature_scales.html">3. Feature Scales</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/3_features_scales/3_Add_Exercises_FeatureScales-v2.html">3.4. Additional Exercises IV -  Feature Scales</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Recap Regression &amp; Correlation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../General_Introduction_Sessions/4_intro_regression/4_1_Intro_Regression.html">4. Linear Regression</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../General_Introduction_Sessions/4_intro_regression/4_2_Intro_Correlation.html">5. Correlation and Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../General_Introduction_Sessions/4_intro_regression/4_3_Additional_Exercises_CorrReg.html">5.2. Additional Exercises V -  Regression &amp; Correlation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Time Series Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="5_00_TSA_intro.html">6. Time Series Analysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="5_01_TSA_Data_preprocessing.html">6.1. Time Series Preprocessing</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.2. Time Series Analysis Methods</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning Algorithms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ML_algorithms/5_ML_Intro.html">7. Machine learning Algorithms I</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ML_algorithms/5_Supervised/5_0_Supervised_ML_intro.html">8. Supervised Machine Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ML_algorithms/5_Supervised/5_1_SVM.html">8.1. Support Vector Machines (SVM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ML_algorithms/5_Supervised/5_2_Decision_Trees.html">8.2. Decision Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ML_algorithms/5_Supervised/5_3_RF_classification.html">8.3. Random Forest Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ML_algorithms/5_Supervised/5_4_RF_regression.html">8.4. Random Forest Regression</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ML_algorithms/6_Unsupervised/6_0_Unsupervised_ML_intro.html">9. Unsupervised Machine Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ML_algorithms/6_Unsupervised/6_1_k-Means.html">9.1. Clustering Algorithms - <span class="math notranslate nohighlight">\(k\)</span>-Means</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Neural Networks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Neural_networks/7_MLP_WF.html">10. Multilayer perceptron (MLP) - the Machine Learning Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/marie202/ML_jupyter_reader" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/marie202/ML_jupyter_reader/issues/new?title=Issue%20on%20page%20%2Fcontents/TSA/5_02_TSA_Data_analysis.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/contents/TSA/5_02_TSA_Data_analysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Time Series Analysis Methods</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-keeling-curve">6.2.1. The Keeling Curve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-decompositon">6.2.2. Seasonal decompositon</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stl-decomposition">6.2.2.1. STL decomposition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additive-decomposition">6.2.2.2. Additive Decomposition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplicative-decomposition">6.2.2.3. Multiplicative Decomposition</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="time-series-analysis-methods">
<h1><span class="section-number">6.2. </span>Time Series Analysis Methods<a class="headerlink" href="#time-series-analysis-methods" title="Link to this heading">#</a></h1>
<p>In this chapter we want to introduce somehands-on time series analysis methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> lab_black
</pre></div>
</div>
</div>
</div>
<section id="the-keeling-curve">
<h2><span class="section-number">6.2.1. </span>The Keeling Curve<a class="headerlink" href="#the-keeling-curve" title="Link to this heading">#</a></h2>
<p>For the purpose of demonstration we download a data set of carbon dioxide (CO<sub>2</sub>) measurements taken at the <a class="reference external" href="https://en.wikipedia.org/wiki/Mauna_Loa_Observatory">Mauna Loa Observatory</a> in Hawaii, the so called <a class="reference external" href="https://en.wikipedia.org/wiki/Keeling_Curve">Keeling Curve</a>.</p>
<p>CO2 PPM - Trends in Atmospheric Carbon Dioxide. Data are sourced from the US Government’s Earth System Research Laboratory, Global Monitoring Division.
Mauna Loa series (which has the longest continuous series since 1958)</p>
<p>The data is downloaded from: <a class="reference external" href="https://datahub.io/core/co2-ppm#data">https://datahub.io/core/co2-ppm#data</a>
and provided by: Trends in Atmospheric Carbon Dioxide, Mauna Loa, Hawaii. Dr. Pieter Tans, NOAA/ESRL (<a class="reference external" href="http://www.esrl.noaa.gov/gmd/ccgg/trends/">www.esrl.noaa.gov/gmd/ccgg/trends/</a>) and Dr. Ralph Keeling, Scripps Institution of Oceanography (<a class="reference external" href="http://scrippsco2.ucsd.edu/">scrippsco2.ucsd.edu/</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, let&#39;s import all the needed libraries.</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">pandas.plotting</span> <span class="kn">import</span> <span class="n">register_matplotlib_converters</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the data set:</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/co2-mm-mlo.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Date&#39;, &#39;Decimal Date&#39;, &#39;Average&#39;, &#39;Interpolated&#39;, &#39;Trend&#39;,
       &#39;Number of Days&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##look at the date format:</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1958-03-01
1      1958-04-01
2      1958-05-01
3      1958-06-01
4      1958-07-01
          ...    
722    2018-05-01
723    2018-06-01
724    2018-07-01
725    2018-08-01
726    2018-09-01
Name: Date, Length: 727, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert date object to datetime</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">])</span>

<span class="c1"># set the &#39;Datum&#39; columns as index:</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Decimal Date</th>
      <th>Average</th>
      <th>Interpolated</th>
      <th>Trend</th>
      <th>Number of Days</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1958-03-01</th>
      <td>1958.208</td>
      <td>315.71</td>
      <td>315.71</td>
      <td>314.62</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-04-01</th>
      <td>1958.292</td>
      <td>317.45</td>
      <td>317.45</td>
      <td>315.29</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-05-01</th>
      <td>1958.375</td>
      <td>317.50</td>
      <td>317.50</td>
      <td>314.71</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-06-01</th>
      <td>1958.458</td>
      <td>-99.99</td>
      <td>317.10</td>
      <td>314.85</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-07-01</th>
      <td>1958.542</td>
      <td>315.86</td>
      <td>315.86</td>
      <td>314.98</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-05-01</th>
      <td>2018.375</td>
      <td>411.24</td>
      <td>411.24</td>
      <td>407.91</td>
      <td>24</td>
    </tr>
    <tr>
      <th>2018-06-01</th>
      <td>2018.458</td>
      <td>410.79</td>
      <td>410.79</td>
      <td>408.49</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2018-07-01</th>
      <td>2018.542</td>
      <td>408.71</td>
      <td>408.71</td>
      <td>408.32</td>
      <td>27</td>
    </tr>
    <tr>
      <th>2018-08-01</th>
      <td>2018.625</td>
      <td>406.99</td>
      <td>406.99</td>
      <td>408.90</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2018-09-01</th>
      <td>2018.708</td>
      <td>405.51</td>
      <td>405.51</td>
      <td>409.02</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
<p>727 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Average&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/ca6c1cf1853b7ba3ba1a6baa31654fd8722562ec0c8e359e34dfa04b879c3468.png" src="../../_images/ca6c1cf1853b7ba3ba1a6baa31654fd8722562ec0c8e359e34dfa04b879c3468.png" />
</div>
</div>
<p>The average column contains the monthly mean CO2 mole fraction determined from daily averages. The mole fraction of CO2, expressed as parts per million (ppm) is the number of molecules of CO2 in every one million molecules of dried air (water vapor removed). Missing months are denoted by −99.99.</p>
<p>To get an impression of the curve let us drop the mising month.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Average</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">99.99</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Decimal Date</th>
      <th>Average</th>
      <th>Interpolated</th>
      <th>Trend</th>
      <th>Number of Days</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1958-03-01</th>
      <td>1958.208</td>
      <td>315.71</td>
      <td>315.71</td>
      <td>314.62</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-04-01</th>
      <td>1958.292</td>
      <td>317.45</td>
      <td>317.45</td>
      <td>315.29</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-05-01</th>
      <td>1958.375</td>
      <td>317.50</td>
      <td>317.50</td>
      <td>314.71</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-07-01</th>
      <td>1958.542</td>
      <td>315.86</td>
      <td>315.86</td>
      <td>314.98</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-08-01</th>
      <td>1958.625</td>
      <td>314.93</td>
      <td>314.93</td>
      <td>315.94</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-05-01</th>
      <td>2018.375</td>
      <td>411.24</td>
      <td>411.24</td>
      <td>407.91</td>
      <td>24</td>
    </tr>
    <tr>
      <th>2018-06-01</th>
      <td>2018.458</td>
      <td>410.79</td>
      <td>410.79</td>
      <td>408.49</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2018-07-01</th>
      <td>2018.542</td>
      <td>408.71</td>
      <td>408.71</td>
      <td>408.32</td>
      <td>27</td>
    </tr>
    <tr>
      <th>2018-08-01</th>
      <td>2018.625</td>
      <td>406.99</td>
      <td>406.99</td>
      <td>408.90</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2018-09-01</th>
      <td>2018.708</td>
      <td>405.51</td>
      <td>405.51</td>
      <td>409.02</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
<p>720 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Average&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/99346431a1fdee1eb36d2d8593b7d7c27fd17c2a423192010f5d1a9c08c23389.png" src="../../_images/99346431a1fdee1eb36d2d8593b7d7c27fd17c2a423192010f5d1a9c08c23389.png" />
</div>
</div>
<p>This characteristic graph showing the rising the CO2 concentration over time is often referred to as <a class="reference external" href="https://en.wikipedia.org/wiki/Keeling_Curve">Keeling Curve</a>. Each year when the terrestrial vegetation of the Northern Hemisphere expands with the seasons, it removes CO2 from the atmosphere in its productive growing phase, while it returns CO2 to the air when it dies and decomposes. This phenomenon creates a seasonal oscillation in the atmosphere’s CO2 concentration.</p>
</section>
<section id="seasonal-decompositon">
<h2><span class="section-number">6.2.2. </span>Seasonal decompositon<a class="headerlink" href="#seasonal-decompositon" title="Link to this heading">#</a></h2>
<p>Time series data can exhibit a huge variety of temporal patterns. In many cases it is useful to categorize these patterns, and further,  split them up into distinct components. In general many time series can be decomposed into three parts:</p>
<ul class="simple">
<li><p><strong>Trend</strong>: A trend exists when there is a long-term increase or decrease in the data.</p></li>
<li><p><strong>Seasonal pattern</strong>:  A seasonal pattern exists when a series is influenced by seasonal factors. Seasonality is always of a fixed and known period.</p></li>
<li><p><strong>Residual</strong>:  The remainder, after accounting for the trend and seasonality; also known as <a class="reference external" href="https://en.wikipedia.org/wiki/White_noise">noise</a>.</p></li>
</ul>
<p>We can principally model such a time series in two ways: as an <strong>additive model</strong> and as a <strong>multiplicative model</strong>.</p>
<p>The additive model can be written as</p>
<div class="math notranslate nohighlight">
\[y_t = T_t + S_t + E_t\text{,}\]</div>
<p>and the multiplicative model can be written as</p>
<div class="math notranslate nohighlight">
\[y_t = T_t \times S_t \times E_t\text{,}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_t\)</span> is the data at period <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(T_t\)</span> is the trend-cycle component, <span class="math notranslate nohighlight">\(S_t\)</span> is the seasonal component and <span class="math notranslate nohighlight">\(E_t\)</span> is the remainder component at period <span class="math notranslate nohighlight">\(t\)</span>.</p>
<blockquote>
<div><p>The <strong>additive model</strong> is most appropriate if the magnitude of the seasonal fluctuations or the variation around the trend-cycle does not change with a trend of the time series. When the variation in the seasonal pattern, or the variation around the trend-cycle, appears to be proportional to the level of the time series, then a <strong>multiplicative mode</strong> is more appropriate.</p>
</div></blockquote>
<section id="stl-decomposition">
<h3><span class="section-number">6.2.2.1. </span>STL decomposition<a class="headerlink" href="#stl-decomposition" title="Link to this heading">#</a></h3>
<p>STL is an acronym for “Seasonal and Trend decomposition using Loess”, while loess (locally weighted regression and scatterplot smoothing) is a method for estimating nonlinear relationships.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">register_matplotlib_converters</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;figure&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time Series Decomposition</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>

<span class="n">result_mul</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Average&quot;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">extrapolate_trend</span><span class="o">=</span><span class="s2">&quot;freq&quot;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Why do we get an error message here possibly?</strong></p>
<p>Because we have missing data! Therefore, we first have to tackle this problem!</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;ME&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ffill&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Average&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/7ecc044f8423b0d2029b8dff66a63ee080ac9ffa90e9c62cfa5c73f3ca718dbe.png" src="../../_images/7ecc044f8423b0d2029b8dff66a63ee080ac9ffa90e9c62cfa5c73f3ca718dbe.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Decimal Date</th>
      <th>Average</th>
      <th>Interpolated</th>
      <th>Trend</th>
      <th>Number of Days</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1958-03-31</th>
      <td>1958.208</td>
      <td>315.71</td>
      <td>315.71</td>
      <td>314.62</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-04-30</th>
      <td>1958.292</td>
      <td>317.45</td>
      <td>317.45</td>
      <td>315.29</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-05-31</th>
      <td>1958.375</td>
      <td>317.50</td>
      <td>317.50</td>
      <td>314.71</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-06-30</th>
      <td>1958.375</td>
      <td>317.50</td>
      <td>317.50</td>
      <td>314.71</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1958-07-31</th>
      <td>1958.542</td>
      <td>315.86</td>
      <td>315.86</td>
      <td>314.98</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-04-30</th>
      <td>2018.292</td>
      <td>410.24</td>
      <td>410.24</td>
      <td>407.45</td>
      <td>21</td>
    </tr>
    <tr>
      <th>2018-05-31</th>
      <td>2018.375</td>
      <td>411.24</td>
      <td>411.24</td>
      <td>407.91</td>
      <td>24</td>
    </tr>
    <tr>
      <th>2018-06-30</th>
      <td>2018.458</td>
      <td>410.79</td>
      <td>410.79</td>
      <td>408.49</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2018-07-31</th>
      <td>2018.542</td>
      <td>408.71</td>
      <td>408.71</td>
      <td>408.32</td>
      <td>27</td>
    </tr>
    <tr>
      <th>2018-08-31</th>
      <td>2018.625</td>
      <td>406.99</td>
      <td>406.99</td>
      <td>408.90</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
<p>726 rows × 5 columns</p>
</div></div></div>
</div>
</section>
<section id="additive-decomposition">
<h3><span class="section-number">6.2.2.2. </span>Additive Decomposition<a class="headerlink" href="#additive-decomposition" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>

<span class="c1"># Time Series Decomposition</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Average&quot;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;additive&quot;</span><span class="p">,</span> <span class="n">extrapolate_trend</span><span class="o">=</span><span class="s2">&quot;freq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">trend</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">seasonal</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">observed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
1958-03-31    315.181196
1958-04-30    315.230983
1958-05-31    315.280771
1958-06-30    315.330558
1958-07-31    315.380345
                 ...    
2018-04-30    408.006437
2018-05-31    408.163232
2018-06-30    408.320027
2018-07-31    408.476822
2018-08-31    408.633616
Freq: ME, Name: trend, Length: 726, dtype: float64
Date
1958-03-31    1.423431
1958-04-30    2.530454
1958-05-31    3.020961
1958-06-30    2.322923
1958-07-31    0.695820
                ...   
2018-04-30    2.530454
2018-05-31    3.020961
2018-06-30    2.322923
2018-07-31    0.695820
2018-08-31   -1.447539
Freq: ME, Name: seasonal, Length: 726, dtype: float64
Date
1958-03-31   -0.894627
1958-04-30   -0.311437
1958-05-31   -0.801732
1958-06-30   -0.153481
1958-07-31   -0.216166
                ...   
2018-04-30   -0.296891
2018-05-31    0.055807
2018-06-30    0.147051
2018-07-31   -0.462642
2018-08-31   -0.196077
Freq: ME, Name: resid, Length: 726, dtype: float64
Date
1958-03-31    315.71
1958-04-30    317.45
1958-05-31    317.50
1958-06-30    317.50
1958-07-31    315.86
               ...  
2018-04-30    410.24
2018-05-31    411.24
2018-06-30    410.79
2018-07-31    408.71
2018-08-31    406.99
Freq: ME, Name: Average, Length: 726, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>These four time series can be plotted directly from the result object by calling the plot() function. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0c26ed529e3f12c787b46b86d7a893c2bc3a9775d2fd70aeec45d57230f9d553.png" src="../../_images/0c26ed529e3f12c787b46b86d7a893c2bc3a9775d2fd70aeec45d57230f9d553.png" />
</div>
</div>
<p>The plot shows four panels. In the uppermost we see the raw data, the Keeling curve. In the subsequent plot we see the trend component, the seasonal component and the remainder. We realize a very strong linear trend in the data set. Let us redo the analysis, however this time we focus on the 21st century.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2000to2020</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">:</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2000to2020</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Decimal Date</th>
      <th>Average</th>
      <th>Interpolated</th>
      <th>Trend</th>
      <th>Number of Days</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-31</th>
      <td>2000.042</td>
      <td>369.29</td>
      <td>369.29</td>
      <td>369.08</td>
      <td>26</td>
    </tr>
    <tr>
      <th>2000-02-29</th>
      <td>2000.125</td>
      <td>369.54</td>
      <td>369.54</td>
      <td>368.83</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2000-03-31</th>
      <td>2000.208</td>
      <td>370.60</td>
      <td>370.60</td>
      <td>369.09</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2000-04-30</th>
      <td>2000.292</td>
      <td>371.81</td>
      <td>371.81</td>
      <td>369.28</td>
      <td>27</td>
    </tr>
    <tr>
      <th>2000-05-31</th>
      <td>2000.375</td>
      <td>371.58</td>
      <td>371.58</td>
      <td>368.71</td>
      <td>28</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-04-30</th>
      <td>2018.292</td>
      <td>410.24</td>
      <td>410.24</td>
      <td>407.45</td>
      <td>21</td>
    </tr>
    <tr>
      <th>2018-05-31</th>
      <td>2018.375</td>
      <td>411.24</td>
      <td>411.24</td>
      <td>407.91</td>
      <td>24</td>
    </tr>
    <tr>
      <th>2018-06-30</th>
      <td>2018.458</td>
      <td>410.79</td>
      <td>410.79</td>
      <td>408.49</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2018-07-31</th>
      <td>2018.542</td>
      <td>408.71</td>
      <td>408.71</td>
      <td>408.32</td>
      <td>27</td>
    </tr>
    <tr>
      <th>2018-08-31</th>
      <td>2018.625</td>
      <td>406.99</td>
      <td>406.99</td>
      <td>408.90</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
<p>224 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2000to2020</span><span class="p">[</span><span class="s2">&quot;Average&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/55222d69ca166e5e11bc8cc5f2560e5a191e7a39870d899e6fd3bfac62df8bb8.png" src="../../_images/55222d69ca166e5e11bc8cc5f2560e5a191e7a39870d899e6fd3bfac62df8bb8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time Series Decomposition</span>
<span class="n">result_add</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span>
    <span class="n">df_2000to2020</span><span class="p">[</span><span class="s2">&quot;Average&quot;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;additive&quot;</span><span class="p">,</span> <span class="n">extrapolate_trend</span><span class="o">=</span><span class="s2">&quot;freq&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result_add</span><span class="o">.</span><span class="n">trend</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_add</span><span class="o">.</span><span class="n">seasonal</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_add</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_add</span><span class="o">.</span><span class="n">observed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-31    368.826526
2000-02-29    368.961396
2000-03-31    369.096267
2000-04-30    369.231137
2000-05-31    369.366007
                 ...    
2018-04-30    408.006437
2018-05-31    408.163232
2018-06-30    408.320027
2018-07-31    408.476822
2018-08-31    408.633616
Freq: ME, Name: trend, Length: 224, dtype: float64
Date
2000-01-31    0.257498
2000-02-29    0.821035
2000-03-31    1.535074
2000-04-30    2.747596
2000-05-31    3.155601
                ...   
2018-04-30    2.747596
2018-05-31    3.155601
2018-06-30    2.321368
2018-07-31    0.456473
2018-08-31   -1.771099
Freq: ME, Name: seasonal, Length: 224, dtype: float64
Date
2000-01-31    0.205976
2000-02-29   -0.242431
2000-03-31   -0.031341
2000-04-30   -0.168733
2000-05-31   -0.941608
                ...   
2018-04-30   -0.514033
2018-05-31   -0.078832
2018-06-30    0.148605
2018-07-31   -0.223295
2018-08-31    0.127483
Freq: ME, Name: resid, Length: 224, dtype: float64
Date
2000-01-31    369.29
2000-02-29    369.54
2000-03-31    370.60
2000-04-30    371.81
2000-05-31    371.58
               ...  
2018-04-30    410.24
2018-05-31    411.24
2018-06-30    410.79
2018-07-31    408.71
2018-08-31    406.99
Freq: ME, Name: Average, Length: 224, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>These four time series can be plotted directly from the result object by calling the plot() function. For example:
from matplotlib import pyplot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="n">result_add</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/156b26c7e3c37f82fb81c6bb720e07fa4d736f1e1217d2d93df75c27937b6354.png" src="../../_images/156b26c7e3c37f82fb81c6bb720e07fa4d736f1e1217d2d93df75c27937b6354.png" />
</div>
</div>
<p>Nice, plot! The bars at its right side are of equal heights in user coordinates. This time it is much easier to spot the seasonal oscillation in the CO2 concentration. The remainder seems quite noisy and is devoid of a particular pattern. This indicates that the seasonal decomposition did a good job in extracting the trend and seasonal components.</p>
</section>
<section id="multiplicative-decomposition">
<h3><span class="section-number">6.2.2.3. </span>Multiplicative Decomposition<a class="headerlink" href="#multiplicative-decomposition" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time Series Decomposition</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span>
    <span class="n">df_2000to2020</span><span class="p">[</span><span class="s2">&quot;Average&quot;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">extrapolate_trend</span><span class="o">=</span><span class="s2">&quot;freq&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3e5c9bb0ef3dad6bf75eac4fc65eeee90a3537be9be6983de8e1e23b00d4fca4.png" src="../../_images/3e5c9bb0ef3dad6bf75eac4fc65eeee90a3537be9be6983de8e1e23b00d4fca4.png" />
</div>
</div>
<p>We see the residuals are all 1. This is a hint that we the multiplicative model is not appropriate.</p>
<hr class="docutils" />
<p>A very typical use case is to apply STL for detrending a time series. We detrend our data set by subtracting the trend from the original data.</p>
<div class="math notranslate nohighlight">
\[y_t^* = y_t- T_t\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detrended</span> <span class="o">=</span> <span class="n">df_2000to2020</span><span class="p">[</span><span class="s2">&quot;Average&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">result_add</span><span class="o">.</span><span class="n">trend</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detrended</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Seasonal variability of CO2 in the atmosphere&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;CO2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;CO2&#39;)
</pre></div>
</div>
<img alt="../../_images/515e72ded30d0eeeae3cc8ce52fb7fc7a1cb6a34dd7ee9c1f252fc0767122313.png" src="../../_images/515e72ded30d0eeeae3cc8ce52fb7fc7a1cb6a34dd7ee9c1f252fc0767122313.png" />
</div>
</div>
<hr class="docutils" />
<p>Let us investigate the remainder and review if the residuals are normally distributed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result_add</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Residiual/Remainder&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;CO2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;CO2&#39;)
</pre></div>
</div>
<img alt="../../_images/dce4bda2762717a5b97854452b2abfa7a9186548cd1dea0ba439c67d24169c8c.png" src="../../_images/dce4bda2762717a5b97854452b2abfa7a9186548cd1dea0ba439c67d24169c8c.png" />
</div>
</div>
<p>Next, wec reate a QQ-plot using the qqnorm() and the qqline() function to check the distribution of the residuals.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">result_add</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;QQ-Plot&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b52efd7c66e8e187d2eaeaab583ea6a659b8bc42ba47c8b88fea7564f3b0c0eb.png" src="../../_images/b52efd7c66e8e187d2eaeaab583ea6a659b8bc42ba47c8b88fea7564f3b0c0eb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># histogram plot</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">result_add</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Residuals&quot;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8dea499e97e19b443941cf2b0e6fa6c6ede0621c40da0187a3f5083e7095b7b1.png" src="../../_images/8dea499e97e19b443941cf2b0e6fa6c6ede0621c40da0187a3f5083e7095b7b1.png" />
</div>
</div>
<p>The residuals seem fairly well normally distributed. This means, that we considered an appropriate model.</p>
<p>Additionally you can apply a <a class="reference external" href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test">Shapiro–Wilk test</a> and check for normality.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contents/TSA"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="5_01_TSA_Data_preprocessing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.1. </span>Time Series Preprocessing</p>
      </div>
    </a>
    <a class="right-next"
       href="../ML_algorithms/5_ML_Intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Machine learning Algorithms I</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-keeling-curve">6.2.1. The Keeling Curve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-decompositon">6.2.2. Seasonal decompositon</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stl-decomposition">6.2.2.1. STL decomposition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additive-decomposition">6.2.2.2. Additive Decomposition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplicative-decomposition">6.2.2.3. Multiplicative Decomposition</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Annette Rudolph, Marie-Christin Eckert
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>