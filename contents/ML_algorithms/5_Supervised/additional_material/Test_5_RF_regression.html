

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Machine learning Algorithms I &#8212; Machine Learning Online Reader</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/ML_algorithms/5_Supervised/additional_material/Test_5_RF_regression';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/logo.png" class="logo__image only-light" alt="Machine Learning Online Reader - Home"/>
    <script>document.write(`<img src="../../../../_static/logo.png" class="logo__image only-dark" alt="Machine Learning Online Reader - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    Machine Learning Intro Course Materials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_0_Intro_to_Python_landing.html">1. Introduction to Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_1_Python_as_calculator.html">1.1. Using Python as calculator</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_2_Build_in_Functions.html">1.3. Use of predefined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_3_data_structures.html">1.4. Data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_4_atomic_datatypes.html">1.5. Datatypes</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_5_objects_data_types.html">1.8. The concept of objects in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_6_Intro_user_defined_functions.html">1.9. User defined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_7_control_flow_mit_Lsg.html">1.10. Steering the control flow of a program</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_8_Pandas_Dataframes.html">1.12. Pandas package for handling <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_9_Exercises_Einf_Python_I.html">1.13. Additional Exercises I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/1_Introduction_to_Python/1_10_Exercises_Einf_Python_II.html">1.14. Additional Exercises II</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Recap Statistics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../General_Introduction_Sessions/2_NVT/2_1_Wdhl_Statisitk_1.html">2. Recap Statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/2_NVT/2_2_Add_Exercises_NVT.html">2.3. Additional Exercises III -  The Normal distribution</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Feature Scales</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../General_Introduction_Sessions/3_features_scales/3_Feature_scales.html">3. Feature Scales</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/3_features_scales/3_Add_Exercises_FeatureScales-v2.html">3.4. Additional Exercises IV -  Feature Scales</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Recap Regression &amp; Correlation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../General_Introduction_Sessions/4_intro_regression/4_1_Intro_Regression.html">4. Linear Regression</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../General_Introduction_Sessions/4_intro_regression/4_2_Intro_Correlation.html">5. Correlation and Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../General_Introduction_Sessions/4_intro_regression/4_3_Additional_Exercises_CorrReg.html">5.2. Additional Exercises V -  Regression &amp; Correlation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning Algorithms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../5_ML_Intro.html">6. Machine learning Algorithms I</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../5_0_Supervised_ML_intro.html">7. Supervised Machine Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../5_1_SVM.html">7.1. Support Vector Machines (SVM)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../6_Unsupervised/6_0_Unsupervised_ML_intro.html">8. Supervised Machine Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../6_Unsupervised/6_1_k-Means.html">8.1. Clustering Algorithms - $k$-Means</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://marie202.github.io/ML_jupyter_reader/_build/html" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://marie202.github.io/ML_jupyter_reader/_build/html/issues/new?title=Issue%20on%20page%20%2Fcontents/ML_algorithms/5_Supervised/additional_material/Test_5_RF_regression.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/contents/ML_algorithms/5_Supervised/additional_material/Test_5_RF_regression.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Machine learning Algorithms I</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-trees-random-forests">5 Decision Trees &amp; Random Forests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rf-tutorial-aims">RF Tutorial Aims:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-trees">1. Decision Trees</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-decision-tree">What is a decision tree</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-how-to-built-a-dt-from-scratch">Exercise - How to built a DT from scratch</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-total-gini-impurity-for-the-node-temperature">Calculating total GINI Impurity for the node “temperature”</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-rf">1. What is a RF?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-it-work">How does it work?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#packages">3. Packages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-set">3. Data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#splitting-the-data">4. Splitting the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-and-evaluating-the-model">5. Fitting and Evaluating the Model</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="machine-learning-algorithms-i">
<h1>Machine learning Algorithms I<a class="headerlink" href="#machine-learning-algorithms-i" title="Permalink to this heading">#</a></h1>
<section id="decision-trees-random-forests">
<h2>5 Decision Trees &amp; Random Forests<a class="headerlink" href="#decision-trees-random-forests" title="Permalink to this heading">#</a></h2>
<p>In this notebook, we will implement a random forest in Python. We’ll start with a single decision tree and a simple problem, and then work our way to a random forest. Once we understand how a single decision tree works, we can transfer this knowledge to an entire forest of trees.</p>
<blockquote>
<div><p>really nice introduction: https://www.youtube.com/watch?v=J4Wdy0Wc_xQ&amp;t=528s</p>
</div></blockquote>
<section id="rf-tutorial-aims">
<h3>RF Tutorial Aims:<a class="headerlink" href="#rf-tutorial-aims" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Random Forest classification with scikit-learn</p></li>
<li><p>How random forests work</p></li>
<li><p>How to use them for regression</p></li>
<li><p>How to evaluate their performance</p></li>
</ul>
</section>
</section>
<section id="decision-trees">
<h2>1. Decision Trees<a class="headerlink" href="#decision-trees" title="Permalink to this heading">#</a></h2>
<section id="what-is-a-decision-tree">
<h3>What is a decision tree<a class="headerlink" href="#what-is-a-decision-tree" title="Permalink to this heading">#</a></h3>
<div>
<img src="5_RF_figures/Decisiontree.png" width="400"/>
</div>
<p>A simple linear classifier will not be able to draw a boundary that separates the classes. The single decision tree will be able to completely separate the points because it essentially draws many repeated linear boundaries between points. A decision tree is a non-parametric model because the number of parameters grows with the size of the data.</p>
<ul class="simple">
<li><p>DTs are easy to built, use and interpret <strong>BUT</strong> they are limited!</p></li>
<li><p>Their main disadvantage: INACCURAY! –&gt; are not flexible with new samples</p></li>
</ul>
</section>
<section id="exercise-how-to-built-a-dt-from-scratch">
<h3>Exercise - How to built a DT from scratch<a class="headerlink" href="#exercise-how-to-built-a-dt-from-scratch" title="Permalink to this heading">#</a></h3>
<p>First, a decision tree is to be generated by hand from the following admittedly rather artificial data set.</p>
<div class="pst-scrollable-table-container"><table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-center head"><p>Clouds</p></th>
<th class="text-center head"><p>Temperature</p></th>
<th class="text-center head"><p>Rain</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>yes</p></td>
<td class="text-center"><p>mild</p></td>
<td class="text-center"><p>yes</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>no</p></td>
<td class="text-center"><p>mild</p></td>
<td class="text-center"><p>no</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>yes</p></td>
<td class="text-center"><p>cold</p></td>
<td class="text-center"><p>no</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>no</p></td>
<td class="text-center"><p>cold</p></td>
<td class="text-center"><p>no</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>no</p></td>
<td class="text-center"><p>hot</p></td>
<td class="text-center"><p>no</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>no</p></td>
<td class="text-center"><p>mild</p></td>
<td class="text-center"><p>no</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>yes</p></td>
<td class="text-center"><p>hot</p></td>
<td class="text-center"><p>yes</p></td>
</tr>
</tbody>
</table>
</div>
<p>The tree should give us the answer as to whether it is raining or not - so “rain” should close the tree as the leaf node. The first step is to determine whether “clouds” or “temperature” is a better choice for the first decision level, i.e. the root node of the tree.</p>
<p>Gini impurity is used for this decision:</p>
<p>\begin{eqnarray*}
Gini(D) = 1 - \sum_{i=1}^k p_i^2.
\end{eqnarray*}</p>
<p>The running index “i” $\in$ [1,2] describes the target classes of the leaf nodes to be distinguished, in this case [rain-yes,rain-no]. The probability $p_1$ or $p_2$ is therefore the probability of rain or no rain in data set D.</p>
<p>The total gini-impurity of a node which splits data set D with $n$ entries into e.g. 2 sub-data sets $D_a$ and $D_b$ with $n_a$ and $n_b$ entries respectively, is calculated from the weighted average of the respective individual gini-impurities:</p>
<p>\begin{eqnarray*}
Gini(D) = \frac{n_a}{n} Gini(D_a) + \frac{n_b}{n} Gini(D_b),
\end{eqnarray*}</p>
<p>where the indices $a$ and $b$ could stand for clouds=yes and clouds=no, for example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gini</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">):</span>
    <span class="n">GI</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">p1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">GI</span>
</pre></div>
</div>
</div>
</div>
<p>We now calculate the total gini-impurity of each of the following possible root nodes:</p>
<p>Clouds $=$ yes or no<br />
Temperature $=$ cold, mild or hot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 1. cloud no</span>
<span class="c1">## results in: rain no --&gt; 4 times, rain yes --&gt; 0 times</span>
<span class="n">p1</span> <span class="o">=</span> <span class="mi">0</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># rain no</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># rain yes</span>

<span class="n">gini</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 2. cloud yes</span>
<span class="c1">## results in: rain no --&gt; 1 times, rain yes --&gt; 2 times</span>

<span class="n">p1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span> <span class="c1"># rain yes</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="c1"># rain no </span>

<span class="n">gini</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4444444444444444
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Calculating total GINI Impurity for the node &quot;clouds&quot;</span>

<span class="n">na</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># total entries of clouds no</span>
<span class="n">nb</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># total entries of clouds yes</span>

<span class="n">p1a</span> <span class="o">=</span> <span class="mi">0</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># cloud no, rain no</span>
<span class="n">p2a</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># cloud no, rain yes</span>

<span class="n">p1b</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span> <span class="c1"># cloud yes, rain yes</span>
<span class="n">p2b</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="c1"># cloud yes, rain no </span>


<span class="k">def</span> <span class="nf">total_gini</span><span class="p">(</span><span class="n">p1a</span><span class="p">,</span><span class="n">p2a</span><span class="p">,</span><span class="n">p1b</span><span class="p">,</span><span class="n">p2b</span><span class="p">,</span><span class="n">na</span><span class="p">,</span> <span class="n">nb</span><span class="p">):</span>
    <span class="n">GI</span> <span class="o">=</span> <span class="n">na</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span> <span class="o">*</span> <span class="n">gini</span><span class="p">(</span><span class="n">p1a</span><span class="p">,</span><span class="n">p2a</span><span class="p">)</span> <span class="o">+</span> <span class="n">nb</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span> <span class="o">*</span> <span class="n">gini</span><span class="p">(</span><span class="n">p1b</span><span class="p">,</span><span class="n">p2b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">GI</span>

<span class="n">total_gini</span><span class="p">(</span><span class="n">p1a</span><span class="p">,</span><span class="n">p2a</span><span class="p">,</span><span class="n">p1b</span><span class="p">,</span><span class="n">p2b</span><span class="p">,</span><span class="n">na</span><span class="p">,</span> <span class="n">nb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.19047619047619047
</pre></div>
</div>
</div>
</div>
<section id="calculating-total-gini-impurity-for-the-node-temperature">
<h4>Calculating total GINI Impurity for the node “temperature”<a class="headerlink" href="#calculating-total-gini-impurity-for-the-node-temperature" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 1. temperature cold </span>
<span class="c1">## results in: rain no --&gt; 2 times, rain yes --&gt; 0 times</span>

<span class="n">p1</span> <span class="o">=</span> <span class="mi">0</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># rain yes</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># rain no </span>

<span class="n">gini</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 2. temperature mild </span>
<span class="c1">## results in: rain no --&gt; 2 times, rain yes --&gt; 1 times</span>

<span class="n">p1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="c1"># rain yes</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span> <span class="c1"># rain no </span>

<span class="n">gini</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4444444444444444
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 2. temperature hot </span>
<span class="c1">## results in: rain no --&gt; 1 times, rain yes --&gt; 1 times</span>

<span class="n">p1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># rain yes</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># rain no </span>

<span class="n">gini</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
</div>
</div>
<p>The node with the lowest total Gini impurity is suitable as the first decision node or root node of the tree.
Now determine the total Gini impurity for the first internal nodes of the 2 remaining discriminators, namely for the 2 branches of the root node.</p>
<p>Here we quickly build and train a single decision tree on the data using Scikit-Learn. The tree will learn how to separate the points, building a flowchart of questions based on the feature values and the labels. At each stage, the decision tree makes splits by maximizing the reduction in Gini impurity.</p>
<p>We’ll use the default hyperparameters for the decision tree which means it can grow as deep as necessary in order to completely separate the classes. This will lead to overfitting because the model memorizes the training data, and in practice, we usually want to limit the depth of the tree so it can generalize to testing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span> <span class="c1"># Import Decision Tree Classifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> <span class="c1"># Import train_test_split function</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span> <span class="c1">#Import scikit-learn metrics module for accuracy calculation</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;clouds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="s1">&#39;rain&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>clouds</th>
      <th>temp</th>
      <th>rain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>10</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>-3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>-5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>25</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>30</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#split dataset in features and target variable</span>
<span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;clouds&#39;</span><span class="p">,</span> <span class="s1">&#39;temp&#39;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span> <span class="c1"># Features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rain</span> <span class="c1"># Target variable</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 0, 0, 0, 0, 0, 1])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split dataset into training set and test set</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 70% training and 30% test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Decision Tree classifer object</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">)</span>

<span class="c1"># Train Decision Tree Classifer</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="c1">#Predict the response for test dataset</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model Accuracy, how often is the classifier correct?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.6666666666666666
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0.5, 0.75, &#39;clouds &lt;= 0.5\ngini = 0.375\nsamples = 4\nvalue = [3, 1]&#39;),
 Text(0.25, 0.25, &#39;gini = 0.0\nsamples = 3\nvalue = [3, 0]&#39;),
 Text(0.75, 0.25, &#39;gini = 0.0\nsamples = 1\nvalue = [0, 1]&#39;)]
</pre></div>
</div>
<img alt="../../../../_images/d9daad214944d7c137a5f882eec9e11e4df787b00337893a3917eda4da458568.png" src="../../../../_images/d9daad214944d7c137a5f882eec9e11e4df787b00337893a3917eda4da458568.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#test_out = {&#39;clouds&#39;: [1], &#39;temp&#39;: [10]}</span>
<span class="c1">#test_out = pd.DataFrame.from_dict(data)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="what-is-a-rf">
<h3>1. What is a RF?<a class="headerlink" href="#what-is-a-rf" title="Permalink to this heading">#</a></h3>
<div>
<img src="5_RF_figures/RF.png" width="500"/>
</div>
<ul class="simple">
<li><p>RF are built by combining mulitple DT (ensemble of decision trees to predict target variables)</p></li>
<li><p>RFs combine simplicity of DTs with flexiblity –&gt; therefore improved accuracy</p></li>
<li><p>RFs are for supervised machine learning, where there is a labeled target variable.</p></li>
<li><p>RFs can be used for solving regression (numeric target variable) and classification (categorical target variable) problems.</p></li>
<li><p>RFs are an ensemble method, meaning they combine predictions from other models.</p></li>
</ul>
<section id="how-does-it-work">
<h4>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this heading">#</a></h4>
<blockquote>
<div><p>A Random forest regression model combines multiple decision trees to create a single model. Each tree in the forest builds from a different subset of the data and makes its own independent prediction. The final prediction for input is based on the average or weighted average of all the individual trees’ predictions.</p>
<p><a class="reference external" href="https://www.analytixlabs.co.in/blog/random-forest-regression/#:~:text=using%20various%20techniques.-,Evaluating%20Random%20Forest%20Regression%20Performance,such%20as%20accuracy%20and%20precision.">Read here more on the theory.</a></p>
</div></blockquote>
<div style="display:flex; align-items: center;padding:70px;">
<img src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*gFYWIpNETvxjYMKBXTh0Qw.jpeg
" width="600"/>
</div>
<p>(figure by <a class="reference external" href="https://medium.com/nerd-for-tech/the-ideal-workflow-for-your-machine-learning-project-9df1a7125b17">Kohari 2020</a> )</p>
</section>
</section>
<section id="packages">
<h3>3. Packages<a class="headerlink" href="#packages" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data Processing</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="c1"># Modelling</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">ConfusionMatrixDisplay</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="c1"># Tree Visualisation</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">export_graphviz</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="c1">#import graphviz</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-set">
<h3>3. Data set<a class="headerlink" href="#data-set" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>aus dem skript der meteos:Aufgabe 2: Random Forests (5 Punkte)</p>
</div></blockquote>
<p>In dieser Übung werden wir einen RF aus aktuellen Berliner Wetterdaten erstellen. Lesen Sie dazu die Datenbeschreibung im Refubium:   https://refubium.fu-berlin.de/handle/fub188/38460</p>
<p>und laden die Datei 01_Tempelhof-1_2006_Daten.zip herunter: https://refubium.fu-berlin.de/bitstream/handle/fub188/38460/01_Tempelhof-1_2006_Daten.zip?sequence=2&amp;isAllowed=y</p>
<p>Zu diesem Datensatz gibt es nochmal eine gesonderte Beschreibung welche Sie sich gern ansehen können: https://refubium.fu-berlin.de/bitstream/handle/fub188/38460/01_Tempelhof-1_Beschreibung.pdf?sequence=3&amp;isAllowed=y</p>
<p>Das Einlesen und Benennen der Daten geht recht einfach (die Variablennamen stehen in der gezipten .csv Datei). In R verwendet man hierfür am besten einen sogenannten Data-Frame. Die Funktion <code class="docutils literal notranslate"><span class="pre">read.table()</span></code> erzeugt diesen automatisch:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Jahr&quot;</span><span class="p">,</span><span class="s2">&quot;Monat&quot;</span><span class="p">,</span><span class="s2">&quot;Tag&quot;</span><span class="p">,</span><span class="s2">&quot;Stunde&quot;</span><span class="p">,</span><span class="s2">&quot;Minute&quot;</span><span class="p">,</span><span class="s2">&quot;WDay&quot;</span><span class="p">,</span><span class="s2">&quot;WoY&quot;</span><span class="p">,</span><span class="s2">&quot;DoY&quot;</span><span class="p">,</span>
<span class="s2">&quot;air_temperature&quot;</span>                            <span class="p">,</span><span class="s2">&quot;air_temperature_guete&quot;</span><span class="p">,</span>                <span class="c1"># C</span>
<span class="s2">&quot;relative_humidity&quot;</span>                          <span class="p">,</span><span class="s2">&quot;relative_humidity_guete&quot;</span><span class="p">,</span>              <span class="c1"># %</span>
<span class="s2">&quot;duration_of_sunshine&quot;</span>                       <span class="p">,</span><span class="s2">&quot;duration_of_sunshine_guete&quot;</span><span class="p">,</span>           <span class="c1"># min                       </span>
<span class="s2">&quot;air_pressure_at_station_level&quot;</span>              <span class="p">,</span><span class="s2">&quot;air_pressure_at_station_level_guete&quot;</span><span class="p">,</span>  <span class="c1"># hPa              </span>
<span class="s2">&quot;air_temperature2&quot;</span>                           <span class="p">,</span><span class="s2">&quot;air_temperature2_guete&quot;</span><span class="p">,</span>                   <span class="c1"># C      </span>
<span class="s2">&quot;height_of_precipitation&quot;</span>                    <span class="p">,</span><span class="s2">&quot;height_of_precipitation_guete&quot;</span><span class="p">,</span>            <span class="c1"># mm       </span>
<span class="s2">&quot;wind_speed_maximum&quot;</span>                         <span class="p">,</span><span class="s2">&quot;wind_speed_maximum_guete&quot;</span><span class="p">,</span>                 <span class="c1"># m/s        </span>
<span class="s2">&quot;soil_temperature&quot;</span>                           <span class="p">,</span><span class="s2">&quot;soil_temperature_guete&quot;</span><span class="p">,</span>                   <span class="c1"># C        </span>
<span class="s2">&quot;wind_speed_mean&quot;</span>                            <span class="p">,</span><span class="s2">&quot;wind_speed_mean_guete&quot;</span><span class="p">,</span>                    <span class="c1"># m/s       </span>
<span class="s2">&quot;global_solar_radiation&quot;</span>                     <span class="p">,</span><span class="s2">&quot;global_solar_radiation_guete&quot;</span><span class="p">,</span>             <span class="c1"># W/m^2        </span>
<span class="s2">&quot;air_temperature3&quot;</span>                           <span class="p">,</span><span class="s2">&quot;air_temperature3_guete&quot;</span><span class="p">,</span>                   <span class="c1"># C        </span>
<span class="s2">&quot;air_temperature4&quot;</span>                           <span class="p">,</span><span class="s2">&quot;air_temperature4_guete&quot;</span><span class="p">,</span>                   <span class="c1"># C       </span>
<span class="s2">&quot;wind_from_direction_at_wind_speed_maximum&quot;</span>  <span class="p">,</span><span class="s2">&quot;wind_from_direction_at_wind_speed_maximum_guete&quot;</span><span class="p">,</span>  <span class="c1"># degree </span>
<span class="s2">&quot;wind_from_direction&quot;</span>                        <span class="p">,</span><span class="s2">&quot;wind_from_direction_guete&quot;</span>  <span class="p">]</span>                 <span class="c1"># degree</span>

<span class="n">use_var</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Jahr&quot;</span><span class="p">,</span><span class="s2">&quot;Monat&quot;</span><span class="p">,</span><span class="s2">&quot;Tag&quot;</span><span class="p">,</span><span class="s2">&quot;Stunde&quot;</span><span class="p">,</span><span class="s2">&quot;Minute&quot;</span><span class="p">,</span><span class="s2">&quot;WoY&quot;</span><span class="p">,</span><span class="s2">&quot;DoY&quot;</span><span class="p">,</span><span class="s2">&quot;air_temperature&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;relative_humidity&quot;</span><span class="p">,</span><span class="s2">&quot;duration_of_sunshine&quot;</span><span class="p">,</span><span class="s2">&quot;air_pressure_at_station_level&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;height_of_precipitation&quot;</span><span class="p">,</span><span class="s2">&quot;wind_speed_maximum&quot;</span> <span class="p">,</span><span class="s2">&quot;soil_temperature&quot;</span> <span class="p">,</span><span class="s2">&quot;wind_speed_mean&quot;</span> <span class="p">,</span>
                    <span class="s2">&quot;global_solar_radiation&quot;</span><span class="p">,</span> <span class="s2">&quot;wind_from_direction_at_wind_speed_maximum&quot;</span><span class="p">,</span><span class="s2">&quot;wind_from_direction&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/01_Tempelhof-1_2006_Daten.csv&#39;</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> 
                   <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">names</span> <span class="o">=</span> <span class="n">variables</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> 
<span class="n">data2use</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">use_var</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/01_Tempelhof-1_2006_Daten.csv&#39;</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span>                    <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                    <span class="n">names</span> <span class="o">=</span> <span class="n">variables</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">data2use</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">use_var</span><span class="p">]</span>

<span class="nn">File /opt/anaconda3/envs/jupyter_book_ml/lib/python3.9/site-packages/pandas/io/parsers/readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/jupyter_book_ml/lib/python3.9/site-packages/pandas/io/parsers/readers.py:620,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">620</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File /opt/anaconda3/envs/jupyter_book_ml/lib/python3.9/site-packages/pandas/io/parsers/readers.py:1620,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1620</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/jupyter_book_ml/lib/python3.9/site-packages/pandas/io/parsers/readers.py:1880,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1878</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1879</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1880</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1881</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1882</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1885</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1888</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1891</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File /opt/anaconda3/envs/jupyter_book_ml/lib/python3.9/site-packages/pandas/io/common.py:873,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">873</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;data/01_Tempelhof-1_2006_Daten.csv&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2use</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jahr                                           int64
Monat                                          int64
Tag                                            int64
Stunde                                         int64
Minute                                         int64
WoY                                            int64
DoY                                            int64
air_temperature                              float64
relative_humidity                            float64
duration_of_sunshine                         float64
air_pressure_at_station_level                float64
height_of_precipitation                      float64
wind_speed_maximum                           float64
soil_temperature                             float64
wind_speed_mean                              float64
global_solar_radiation                       float64
wind_from_direction_at_wind_speed_maximum    float64
wind_from_direction                          float64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2use</span> <span class="o">=</span> <span class="n">data2use</span><span class="p">[</span><span class="n">data2use</span><span class="p">[</span><span class="s1">&#39;soil_temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2use</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Jahr</th>
      <th>Monat</th>
      <th>Tag</th>
      <th>Stunde</th>
      <th>Minute</th>
      <th>WoY</th>
      <th>DoY</th>
      <th>air_temperature</th>
      <th>relative_humidity</th>
      <th>duration_of_sunshine</th>
      <th>air_pressure_at_station_level</th>
      <th>height_of_precipitation</th>
      <th>wind_speed_maximum</th>
      <th>soil_temperature</th>
      <th>wind_speed_mean</th>
      <th>global_solar_radiation</th>
      <th>wind_from_direction_at_wind_speed_maximum</th>
      <th>wind_from_direction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2006</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.3</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>993.3</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>0.1</td>
      <td>3.1</td>
      <td>0.0</td>
      <td>205.0</td>
      <td>211.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2006</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2.4</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>993.3</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>0.1</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>213.0</td>
      <td>205.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2006</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2.3</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>993.3</td>
      <td>0.0</td>
      <td>4.1</td>
      <td>0.1</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>223.0</td>
      <td>210.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2006</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2.4</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>993.3</td>
      <td>0.0</td>
      <td>3.7</td>
      <td>0.1</td>
      <td>3.3</td>
      <td>0.0</td>
      <td>213.0</td>
      <td>213.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2006</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2.4</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>993.3</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>0.1</td>
      <td>3.2</td>
      <td>0.0</td>
      <td>223.0</td>
      <td>216.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>525595</th>
      <td>2006</td>
      <td>12</td>
      <td>31</td>
      <td>23</td>
      <td>55</td>
      <td>53</td>
      <td>365</td>
      <td>7.2</td>
      <td>80.0</td>
      <td>0.0</td>
      <td>1009.5</td>
      <td>0.0</td>
      <td>6.8</td>
      <td>4.6</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>223.0</td>
      <td>204.0</td>
    </tr>
    <tr>
      <th>525596</th>
      <td>2006</td>
      <td>12</td>
      <td>31</td>
      <td>23</td>
      <td>56</td>
      <td>53</td>
      <td>365</td>
      <td>7.1</td>
      <td>81.0</td>
      <td>0.0</td>
      <td>1009.5</td>
      <td>0.0</td>
      <td>5.6</td>
      <td>4.6</td>
      <td>4.6</td>
      <td>0.0</td>
      <td>213.0</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>525597</th>
      <td>2006</td>
      <td>12</td>
      <td>31</td>
      <td>23</td>
      <td>57</td>
      <td>53</td>
      <td>365</td>
      <td>7.1</td>
      <td>81.0</td>
      <td>0.0</td>
      <td>1009.5</td>
      <td>0.0</td>
      <td>6.9</td>
      <td>4.6</td>
      <td>5.7</td>
      <td>0.0</td>
      <td>208.0</td>
      <td>206.0</td>
    </tr>
    <tr>
      <th>525598</th>
      <td>2006</td>
      <td>12</td>
      <td>31</td>
      <td>23</td>
      <td>58</td>
      <td>53</td>
      <td>365</td>
      <td>7.1</td>
      <td>81.0</td>
      <td>0.0</td>
      <td>1009.5</td>
      <td>0.0</td>
      <td>6.9</td>
      <td>4.6</td>
      <td>5.2</td>
      <td>0.0</td>
      <td>198.0</td>
      <td>202.0</td>
    </tr>
    <tr>
      <th>525599</th>
      <td>2006</td>
      <td>12</td>
      <td>31</td>
      <td>23</td>
      <td>59</td>
      <td>53</td>
      <td>365</td>
      <td>7.2</td>
      <td>81.0</td>
      <td>0.0</td>
      <td>1009.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>4.6</td>
      <td>5.3</td>
      <td>0.0</td>
      <td>205.0</td>
      <td>203.0</td>
    </tr>
  </tbody>
</table>
<p>525476 rows × 18 columns</p>
</div></div></div>
</div>
</section>
<section id="splitting-the-data">
<h3>4. Splitting the data<a class="headerlink" href="#splitting-the-data" title="Permalink to this heading">#</a></h3>
<p>test and train set</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the data into features (X) and target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data2use</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;soil_temperature&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data2use</span><span class="p">[</span><span class="s1">&#39;soil_temperature&#39;</span><span class="p">]</span>

<span class="c1"># Split the data into training and test sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="fitting-and-evaluating-the-model">
<h3>5. Fitting and Evaluating the Model<a class="headerlink" href="#fitting-and-evaluating-the-model" title="Permalink to this heading">#</a></h3>
<p>We first create an instance of the Random Forest model, with the default parameters. We then fit this to our training data. We pass both the features and the target variable, so the model can learn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RegModel</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">max_features</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#rf.fit(X_train, y_train)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RandomForestRegressor(n_estimators=51)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Creating the model on Training Data</span>
<span class="n">rf</span><span class="o">=</span><span class="n">RegModel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predicting the target values of the test set</span>
<span class="n">prediction</span><span class="o">=</span><span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Measuring Goodness of fit in Training data</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R2 Value:&#39;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R2 Value: 0.999904066777259
R-squared: 0.9993672364638743
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluating the model</span>
<span class="c1"># Measuring Goodness of fit in Test and preditciton data </span>
<span class="c1">## r2</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R-squared: </span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">## mse</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>

<span class="c1"># RMSE (Root Mean Square Error)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)),</span> <span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">RMSE: &quot;</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R-squared: 0.9993672364638743
0.07080380091429625
0.2660898361724781

RMSE:  0.266
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plotting the feature importance for Top 10 most important columns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">feature_importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">feature_importances</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feature importances using MDI&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean decrease in impurity&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/e767326b40255ec7171f52c58b5e801de14261398b68187680defda8a23e38bb.png" src="../../../../_images/e767326b40255ec7171f52c58b5e801de14261398b68187680defda8a23e38bb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>105096
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access the OOB Score</span>
<span class="c1">#oob_score = rf.oob_score_</span>
<span class="c1">#print(f&#39;Out-of-Bag Score: {oob_score}&#39;)</span>
 
<span class="c1"># Making predictions on the same data or new data</span>
<span class="c1">#predictions = rf.predict(x)</span>
 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Squared Error: 0.07080380091429625
R-squared: 0.9993672364638743
</pre></div>
</div>
</div>
</div>
<p>Hence, the Random Forest Regression algorithm is a powerful Machine Learning algorithm that does not require a lot of parameter tuning and is capable of capturing a broader picture of the data. However, the model when applied to larger data sets can become time-consuming and requires large computational powe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dates of predictions</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">test_features</span><span class="p">[:,</span> <span class="n">feature_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)]</span>
<span class="n">days</span> <span class="o">=</span> <span class="n">test_features</span><span class="p">[:,</span> <span class="n">feature_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)]</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">test_features</span><span class="p">[:,</span> <span class="n">feature_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)]</span>
<span class="c1"># Column of dates</span>
<span class="n">test_dates</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">month</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">day</span><span class="p">))</span> <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="n">days</span><span class="p">)]</span>
<span class="c1"># Convert to datetime objects</span>
<span class="n">test_dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">test_dates</span><span class="p">]</span>
<span class="c1"># Dataframe with predictions and dates</span>
<span class="n">predictions_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">test_dates</span><span class="p">,</span> <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">})</span>
<span class="c1"># Plot the actual values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">true_data</span><span class="p">[</span><span class="s1">&#39;actual&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;actual&#39;</span><span class="p">)</span>
<span class="c1"># Plot the predicted values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predictions_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">predictions_data</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="s1">&#39;60&#39;</span><span class="p">);</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="c1"># Graph labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Maximum Temperature (F)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Actual and Predicted Values&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dates of training values</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)]</span>
<span class="n">days</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)]</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)]</span>
<span class="c1"># List and then convert to datetime object</span>
<span class="c1">#dates = [str(int(year)) + &#39;-&#39; + str(int(month)) + &#39;-&#39; + str(int(day)) for year, month, day in zip(years, months, days)]</span>
<span class="c1">#dates = [datetime.datetime.strptime(date, &#39;%Y-%m-%d&#39;) for date in dates]</span>
<span class="c1">## Dataframe with true values and dates</span>
<span class="c1">#true_data = pd.DataFrame(data = {&#39;date&#39;: dates, &#39;actual&#39;: labels})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">66</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Dates of training values</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">months</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">days</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">years</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)]</span>

<span class="ne">NameError</span>: name &#39;features&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plt.plot(prediction, &#39;ro&#39;, label = &#39;prediction&#39;)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>105096
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;DoY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;DoY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#plt.scatter(X_test[&#39;RM&#39;].values, y_pred, color = &#39;green&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Random Forest Regression&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RM&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/4143939d6dd3a427fef283ce20294fe6b1aecf6810ec5675fa2b75faa06eb73a.png" src="../../../../_images/4143939d6dd3a427fef283ce20294fe6b1aecf6810ec5675fa2b75faa06eb73a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Jahr</th>
      <th>Monat</th>
      <th>Tag</th>
      <th>Stunde</th>
      <th>Minute</th>
      <th>WDay</th>
      <th>WoY</th>
      <th>DoY</th>
      <th>air_temperature</th>
      <th>relative_humidity</th>
      <th>duration_of_sunshine</th>
      <th>air_pressure_at_station_level</th>
      <th>height_of_precipitation</th>
      <th>wind_speed_maximum</th>
      <th>wind_speed_mean</th>
      <th>global_solar_radiation</th>
      <th>wind_from_direction_at_wind_speed_maximum</th>
      <th>wind_from_direction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>69650</th>
      <td>2006</td>
      <td>2</td>
      <td>18</td>
      <td>8</td>
      <td>50</td>
      <td>6</td>
      <td>7</td>
      <td>49</td>
      <td>4.3</td>
      <td>86.0</td>
      <td>0.9</td>
      <td>992.7</td>
      <td>0.0</td>
      <td>6.4</td>
      <td>5.3</td>
      <td>355.0</td>
      <td>225.0</td>
      <td>224.0</td>
    </tr>
    <tr>
      <th>202122</th>
      <td>2006</td>
      <td>5</td>
      <td>21</td>
      <td>8</td>
      <td>42</td>
      <td>0</td>
      <td>21</td>
      <td>141</td>
      <td>12.2</td>
      <td>93.0</td>
      <td>0.0</td>
      <td>994.8</td>
      <td>0.0</td>
      <td>7.8</td>
      <td>6.2</td>
      <td>22.0</td>
      <td>270.0</td>
      <td>272.0</td>
    </tr>
    <tr>
      <th>119450</th>
      <td>2006</td>
      <td>3</td>
      <td>24</td>
      <td>22</td>
      <td>50</td>
      <td>5</td>
      <td>12</td>
      <td>83</td>
      <td>3.6</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>1000.1</td>
      <td>0.0</td>
      <td>4.5</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>140.0</td>
      <td>133.0</td>
    </tr>
    <tr>
      <th>425168</th>
      <td>2006</td>
      <td>10</td>
      <td>23</td>
      <td>6</td>
      <td>8</td>
      <td>1</td>
      <td>43</td>
      <td>296</td>
      <td>12.9</td>
      <td>92.0</td>
      <td>0.0</td>
      <td>994.3</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>3.4</td>
      <td>0.0</td>
      <td>190.0</td>
      <td>193.0</td>
    </tr>
    <tr>
      <th>315611</th>
      <td>2006</td>
      <td>8</td>
      <td>8</td>
      <td>4</td>
      <td>11</td>
      <td>2</td>
      <td>32</td>
      <td>220</td>
      <td>17.2</td>
      <td>96.0</td>
      <td>0.0</td>
      <td>1004.5</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.2</td>
      <td>0.0</td>
      <td>303.0</td>
      <td>348.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>349260</th>
      <td>2006</td>
      <td>8</td>
      <td>31</td>
      <td>13</td>
      <td>0</td>
      <td>4</td>
      <td>35</td>
      <td>243</td>
      <td>18.7</td>
      <td>54.0</td>
      <td>0.0</td>
      <td>1013.3</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>4.4</td>
      <td>37.0</td>
      <td>275.0</td>
      <td>312.0</td>
    </tr>
    <tr>
      <th>424800</th>
      <td>2006</td>
      <td>10</td>
      <td>23</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>43</td>
      <td>296</td>
      <td>12.6</td>
      <td>89.0</td>
      <td>0.0</td>
      <td>996.9</td>
      <td>0.0</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>173.0</td>
      <td>172.0</td>
    </tr>
    <tr>
      <th>302848</th>
      <td>2006</td>
      <td>7</td>
      <td>30</td>
      <td>7</td>
      <td>28</td>
      <td>0</td>
      <td>31</td>
      <td>211</td>
      <td>22.3</td>
      <td>80.0</td>
      <td>1.0</td>
      <td>1005.4</td>
      <td>0.0</td>
      <td>2.8</td>
      <td>2.4</td>
      <td>402.0</td>
      <td>288.0</td>
      <td>282.0</td>
    </tr>
    <tr>
      <th>42702</th>
      <td>2006</td>
      <td>1</td>
      <td>30</td>
      <td>15</td>
      <td>42</td>
      <td>1</td>
      <td>5</td>
      <td>30</td>
      <td>-0.1</td>
      <td>93.0</td>
      <td>0.0</td>
      <td>1021.6</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>2.9</td>
      <td>0.0</td>
      <td>278.0</td>
      <td>278.0</td>
    </tr>
    <tr>
      <th>130185</th>
      <td>2006</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>45</td>
      <td>6</td>
      <td>13</td>
      <td>91</td>
      <td>12.8</td>
      <td>70.0</td>
      <td>0.0</td>
      <td>1004.0</td>
      <td>0.0</td>
      <td>6.3</td>
      <td>5.4</td>
      <td>40.0</td>
      <td>278.0</td>
      <td>277.0</td>
    </tr>
  </tbody>
</table>
<p>105096 rows × 18 columns</p>
</div></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contents/ML_algorithms/5_Supervised/additional_material"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-trees-random-forests">5 Decision Trees &amp; Random Forests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rf-tutorial-aims">RF Tutorial Aims:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-trees">1. Decision Trees</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-decision-tree">What is a decision tree</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-how-to-built-a-dt-from-scratch">Exercise - How to built a DT from scratch</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-total-gini-impurity-for-the-node-temperature">Calculating total GINI Impurity for the node “temperature”</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-rf">1. What is a RF?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-it-work">How does it work?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#packages">3. Packages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-set">3. Data set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#splitting-the-data">4. Splitting the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-and-evaluating-the-model">5. Fitting and Evaluating the Model</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Annette Rudolph, Marie-Christin Eckert
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>